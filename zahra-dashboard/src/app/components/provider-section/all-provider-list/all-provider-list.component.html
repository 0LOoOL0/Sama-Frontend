<span class="loader" id="loader" style="display: none;">
</span>
<div class="w-full p-2">

<div class="w-full  bg-white rounded-lg xl:p-8 px-4 py-6 ms-auto">
  <div class="mainhead w-full flex">

    <div class="2nd w-full">
      <h1 class="text-2xl font-semibold text-[#5E17EB] ">All Providers Page</h1>
      <div class="flex justify-end">
        <button class="bg-red-500 text-white px-4 py-2 rounded-2xl hover:bg-red-600" routerLink="/add-new-provider">
          Add Provider
        </button>
      </div>
      <br><br>

      <!-- Status Filters -->
      <div class="flex flex-wrap gap-4 mb-6">
        <span
          class="w-[150px] px-4 py-2 bg-blue-500 text-white rounded-full text-center flex justify-center items-center">Providers
          No. {{ providersCount }}</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#5e17eb] text-white rounded-full text-center flex justify-center items-center">VET
          clinic No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#fb4848] text-white rounded-full text-center flex justify-center items-center">Groomer
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#f3cfcf] text-white rounded-full text-center flex justify-center items-center">Shops
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#4b0081] text-white rounded-full text-center flex justify-center items-center">Doctors
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#03c3ec] text-white rounded-full text-center flex justify-center items-center">Accomo
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#c5c5cf] text-white rounded-full text-center flex justify-center items-center">Trainer
          No.</span>
      </div>

      <div class="flex flex-wrap gap-4 mb-6">
        <span
          class="w-[150px] px-4 py-2 bg-[#5856d6] text-white rounded-full text-center flex justify-center items-center">Application
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#ff8b00] text-white rounded-full text-center flex justify-center items-center">Waiting
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-[#9B040B] text-white rounded-full text-center flex justify-center items-center">Expired
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-green-600 text-white rounded-full text-center flex justify-center items-center">Approved
          No.</span>
        <span
          class="w-[150px] px-4 py-2 bg-yellow-200 text-yellow-800 rounded-full cursor-pointer text-center flex justify-center items-center"
          (click)="showDeactiveProvidersCount()">Offline</span>
        <span
          class="w-[150px] px-4 py-2 bg-green-200 text-green-800 rounded-full cursor-pointer text-center flex justify-center items-center"
          (click)="showActiveProvidersCount()">Online</span>
      </div>
    </div>
  </div>

  <!-- Filter Inputs -->
  <div class="my-5">
    <div class="grid grid-cols-12 gap-4">
      <!-- Filter From -->
      <div class="xl:col-span-2 sm:col-span-4 col-span-12">
        <div class="fillterCard">
          <label class="font-normal text-[15px] text-[#232323] block mb-1">Filter From:</label>
          <div class="border-[1px] border-[#CED1D5] px-3 py-2 rounded-[20px] w-full">
            <input id="from-date" type="date" (change)="filterByDateRange($event)"
              class="w-full text-xs text-[#718EBF] font-normal outline-none focus:ring-purple-500 focus:border-purple-500" />
          </div>
        </div>
      </div>
  
      <!-- Filter To -->
      <div class="xl:col-span-2 sm:col-span-4 col-span-12">
        <div class="fillterCard">
          <label class="font-normal text-[15px] text-[#232323] block mb-1">To:</label>
          <div class="border-[1px] border-[#CED1D5] px-3 py-2 rounded-[20px] w-full">
            <input id="to-date" type="date" (change)="filterByDateRange($event)"
              class="w-full text-xs text-[#718EBF] font-normal outline-none focus:ring-blue-500 focus:border-blue-500" />
          </div>
        </div>
      </div>
  
      <!-- Filter City -->
      <div class="xl:col-span-2 sm:col-span-4 col-span-12">
        <div class="fillterCard">
          <label class="font-normal text-[15px] text-[#232323] block mb-1">City:</label>
          <div class="border-[1px] border-[#CED1D5] px-3 py-2 rounded-[20px] w-full">
            <input id="city" type="text" placeholder="Enter City" (input)="filterByCity($event)"
              class="w-full text-xs text-[#718EBF] font-normal outline-none focus:ring-blue-500 focus:border-purple-500" />
          </div>
        </div>
      </div>
    </div>
  </div>
  
<br>
  <!-- Import/Export Buttons -->
  <div class="flex justify-between items-center mb-4">
    <input #fileInput type="file" accept=".csv" style="display: none" (change)="onFileImport($event)" />
    <div class="flex space-x-2">
      <button
        class="w-[150px] px-4 py-2 bg-green-500 text-white rounded-full text-center flex justify-center items-center"
        (click)="triggerFileInput()">
        Import
      </button>
      <button
        class="w-[150px] px-4 py-2 bg-green-500 text-white rounded-full text-center flex justify-center items-center"
        (click)="exportToCSV()">
        Export
      </button>
    </div>

    <div class="relative">
      <input type="text" placeholder="Search by Provider Name..." (input)="filterByName($event)"
        class="border border-gray-300 rounded-full py-2 pl-8 pr-4 w-64 text-sm focus:ring-blue-500 focus:border-blue-500" />
      <img src="Image/search.png" alt="Search Icon" class="absolute top-3.5 left-2.5 h-3.5" />
    </div>
  </div>

  <!-- Table -->
  <div class="overflow-x-auto">
    <div class="overflow-x-auto">
      <table class="min-w-full bg-white rounded-lg shadow-md table-auto">
        <thead class="bg-[#5e16ea] text-white">
          <tr class="border-t last:border-b border-gray-300">
            <th class="px-6 py-6 text-left">
              <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500">
            </th>
            <th class="px-4 py-2 text-left">Process</th>
            <th class="px-4 py-2 text-left">Provider Name</th>
            <th class="px-4 py-2 text-left">Start Date</th>
            <th class="px-4 py-2 text-left">Type of Provider</th>
            <th class="px-4 py-2 text-left">Place</th>
            <th class="px-4 py-2 text-left">Contact</th>
            <th class="px-4 py-2 text-left">Email</th> <!-- Custom class for the email column -->
            <th class="px-4 py-2 text-left">Status</th>
            <th class="px-4 py-2 text-left">Actions</th>
          </tr>
        </thead>

        <tbody *ngIf="filteredProviders.length > 0; else noData">
          <tr class="border-t hover:bg-gray-50" *ngFor="let provider of filteredProviders"
            >
            <td class="px-6 py-6 text-left">
              <input type="checkbox" class="form-checkbox h-4 w-4 text-blue-600 rounded focus:ring-blue-500" />
            </td>
            <td class="px-4 py-2">Application</td>
            <td class="px-4 py-2" (click)="navigateToProfile(provider)">{{ provider?.provider_name_en || 'No Data' }}</td>
            <td class="px-4 py-2">{{ provider?.created_at ? provider.created_at.split('T')[0] : 'No Data' }}</td>
            <td class="px-4 py-2">{{ provider?.type || 'No Data' }}</td>
            <td class="px-4 py-2">{{ provider?.city || 'No Data' }}</td>
            <td class="px-4 py-2">{{ provider?.contact_no || 'No Data' }}</td>
            <td class="px-4 py-2 email-column truncate break-words">{{ provider?.email || 'No Data' }}</td>
            <td class="flex justify-center items-center py-4 px-4">
              <span [ngClass]="{
                    'bg-[#E7E7FF] text-[#696CFF] font-bold': provider?.status?.toLowerCase() === 'active',
                    'bg-[#FFF2D6] text-[#FFAB00] font-bold': provider?.status?.toLowerCase() === 'deactive',
                    'bg-gray-200 text-white font-bold': !provider?.status || provider?.status?.toLowerCase() === 'unknown',
                    'bg-[#E8FADF] text-[#71DD37] font-bold': provider?.status?.toLowerCase() === 'completed'
                  }" class="px-2 py-1 rounded-xl inline-block">
                {{ provider?.status || 'Unknown' }}
              </span>
            </td>

            <td class="py-2 px-4 text-center">
              <div class="flex items-center justify-center space-x-2">
                <label class="relative inline-flex items-center cursor-pointer">
                  <input type="checkbox" class="sr-only peer" [checked]="provider.status === 'active'"
                    (change)="ControlProvider(provider.id)" />
                    <div
                    class="w-10 h-5 bg-red-500 rounded-full peer-checked:bg-green-500 peer-focus:ring-2 peer-focus:ring-offset-2 peer-focus:ring-blue-700 transition-colors duration-300">
                </div>
                <span
                    class="w-3 h-3 bg-white rounded-full shadow-md transform peer-checked:translate-x-5 peer-checked:bg-green-100 absolute left-1 top-1 transition-transform duration-300"></span>
            </label>
                <img src="biin.png" alt="" class="h-5 cursor-pointer" (click)="deleteProvider(provider.id)" />
                <img src="edit-pic.png" alt="" class="h-5 cursor-pointer" (click)="navigateToProfile(provider)" />
              </div>
            </td>
          </tr>
        </tbody>

        <ng-template #noData>
          <tr>
            <td colspan="10" class="text-center py-4 text-gray-500">
              No data available
            </td>
          </tr>
        </ng-template>
      </table>
    </div>

    <div class="mt-12 flex justify-center items-center w-full">
      <div class="flex items-center sm:justify-center sm:gap-6 gap-3 px-5 justify-center">
        <button
          class="flex items-center justify-center gap-2 cursor-pointer text-[#5E17EB] text-xs font-normal hover:text-black duration-500">
          <img src="Image/left-arrow.svg" alt="arrow left" />
          Previous
        </button>

        <!-- Pagination -->
        <div class="flex items-center">
          <button
            class="sm:py-3 sm:px-4 px-2 py-1 rounded-lg text-white font-normal text-xs bg-[#5E17EB] hover:bg-[#5E17EB] hover:text-white duration-1000">
            1
          </button>
          <button
            class="sm:py-3 sm:px-4 px-2 py-1 rounded-lg text-black font-normal text-xs hover:bg-[#5E17EB] hover:text-white duration-1000">
            2
          </button>
          <button
            class="sm:py-3 sm:px-4 px-2 py-1 rounded-lg text-black font-normal text-xs hover:bg-[#5E17EB] hover:text-white duration-1000">
            3
          </button>
          <button
            class="sm:py-3 sm:px-4 px-2 py-1 rounded-lg text-black font-normal text-xs hover:bg-[#5E17EB] hover:text-white duration-1000">
            4
          </button>
        </div>

        <button
          class="flex items-center justify-center gap-2 cursor-pointer text-[#5E17EB] text-xs font-normal hover:text-black duration-500">
          Next
          <img src="Image/right-arrow.svg" alt="arrow right" />
        </button>
      </div>
    </div>

  </div>
</div></div>
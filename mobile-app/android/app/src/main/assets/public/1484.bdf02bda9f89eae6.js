"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1484],{1484:(L,h,c)=>{c.r(h),c.d(h,{OrdersPageModule:()=>B});var w=c(9351),m=c(7199),e=c(7473),d=c(4170);const g="data:image/svg+xml;utf8,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' class='ionicon'><path d='M416 64h-16V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 00368 48v16H144V48.45c0-8.61-6.62-16-15.23-16.43A16 16 0 00112 48v16H96a64 64 0 00-64 64v12a4 4 0 004 4h440a4 4 0 004-4v-12a64 64 0 00-64-64zM477 176H35a3 3 0 00-3 3v237a64 64 0 0064 64h320a64 64 0 0064-64V179a3 3 0 00-3-3zM224 307.43A28.57 28.57 0 01195.43 336h-70.86A28.57 28.57 0 0196 307.43v-70.86A28.57 28.57 0 01124.57 208h70.86A28.57 28.57 0 01224 236.57z'/></svg>";var s=c(315),p=c(878),r=c(496);let x=(()=>{var n;class t{constructor(){this.apiUrl=`${p.c.apiUrl}/api/payments`,r.A.interceptors.request.use(o=>{const a=localStorage.getItem("token");return a&&(o.headers.Authorization=`Bearer ${a}`),o},o=>Promise.reject(o))}storePayment(o){return r.A.post(`${this.apiUrl}`,o).then(a=>a.data).catch(a=>Promise.reject(a))}getPaymentById(o){return r.A.get(`${this.apiUrl}/${o}`).then(a=>a.data).catch(a=>Promise.reject(a))}updatePayment(o,a){return r.A.put(`${this.apiUrl}/${o}`,a).then(i=>i.data).catch(i=>Promise.reject(i))}getPaymentsByUserId(o){return r.A.get(`${this.apiUrl}/pet-owner/${o}`).then(a=>a.data).catch(a=>Promise.reject(a))}}return(n=t).\u0275fac=function(o){return new(o||n)},n.\u0275prov=s.jDH({token:n,factory:n.\u0275fac,providedIn:"root"}),t})();const u=(n,t)=>({delivered:n,"not-delivered":t});function M(n,t){if(1&n&&(s.j41(0,"div",9)(1,"div",10)(2,"div",11)(3,"ion-label",12),s.EFF(4),s.k0s()()(),s.j41(5,"div",13)(6,"div",14)(7,"div",15)(8,"ion-label",16),s.EFF(9),s.k0s(),s.j41(10,"ion-label",17),s.EFF(11),s.k0s(),s.j41(12,"ion-label",18),s.EFF(13),s.k0s()(),s.j41(14,"div",19)(15,"div")(16,"ion-label",20),s.EFF(17," 33 items"),s.k0s()()()()(),s.nrm(18,"br"),s.k0s()),2&n){let l;const o=t.$implicit;s.R7$(2),s.Y8G("ngClass",s.l_i(5,u,"completed"===o.status,"completed"!==o.status)),s.R7$(2),s.JRh(o.status),s.R7$(5),s.JRh(o.description),s.R7$(2),s.SpI(" Total: $",o.amount," "),s.R7$(2),s.SpI("You Paid: $",o.amount-(null!==(l=null==o?null:o.discount_amount)&&void 0!==l?l:0),"")}}function z(n,t){if(1&n&&(s.j41(0,"div")(1,"div",5)(2,"div",6)(3,"ion-label",7),s.EFF(4),s.k0s()(),s.DNE(5,M,19,8,"div",8),s.k0s()()),2&n){const l=t.$implicit,o=s.XpG();s.R7$(4),s.JRh(o.formatDate(l.date)),s.R7$(),s.Y8G("ngForOf",l.payments)}}const k=[{path:"",component:(()=>{var n;class t{constructor(o,a){this.alertController=o,this.paymentService=a,this.toggleItems={},this.payments=[],this.userId=21,this.groupedPayments=[],this.orders=[{orderId:"12345",restaurantName:"Burger King",restaurantLogo:"assets/mypet.svg",orderStatus:"Delivered",orderDate:"2024-08-10",deliveryTime:"1:30 pm",totalAmount:15.99,DisountTotalAmount:10,items:[{itemName:"Whopper Meal",quantity:1,price:7.99},{itemName:"Coca-Cola",quantity:1,price:1.99}]},{orderId:"67890",restaurantName:"Pizza Hut",restaurantLogo:"assets/catPlaceHolder.svg",orderStatus:"Pending",orderDate:"2024-08-11",deliveryTime:"8:30 pm",totalAmount:22.49,DisountTotalAmount:18.53,items:[{itemName:"Large Pepperoni Pizza",quantity:1,price:14.99},{itemName:"Garlic Bread",quantity:2,price:4.5},{itemName:"Pepsi",quantity:2,price:1.5}]},{orderId:"54321",restaurantName:"Starbucks",restaurantLogo:"assets/DogPlaceHolder.svg",orderStatus:"Delivered",orderDate:"2024-08-09",deliveryTime:"11:00 am",totalAmount:10.5,DisountTotalAmount:6.99,items:[{itemName:"Caramel Macchiato",quantity:1,price:4.5},{itemName:"Blueberry Muffin",quantity:1,price:3},{itemName:"Latte",quantity:1,price:3}]}],this.groupedOrders=[]}ngOnInit(){this.groupOrdersByDate(),this.fetchPaymentsByUserId(this.userId)}fetchPaymentsByUserId(o){this.paymentService.getPaymentsByUserId(o).then(a=>{const i=a.payments;Array.isArray(i)?(this.payments=i,console.log("Payments fetched:",i),this.groupPaymentsByDate()):(console.error("Expected payments to be an array but got:",i),this.alertController.create({header:"Error",message:"Invalid payment data received.",buttons:["OK"]}).then(v=>v.present()))}).catch(a=>{console.error("Error fetching payments:",a),this.alertController.create({header:"Error",message:"Could not fetch payment history.",buttons:["OK"]}).then(i=>i.present())})}groupPaymentsByDate(){if(!Array.isArray(this.payments))return void console.error("Expected this.payments to be an array but got:",this.payments);const o={};this.payments.forEach(a=>{if(a.payment_date&&"string"==typeof a.payment_date){const i=a.payment_date.split(" ")[0];o[i]||(o[i]=[]),o[i].push(a)}else console.warn("Invalid payment_date for payment:",a)}),this.groupedPayments=Object.keys(o).sort((a,i)=>{const v=this.getTodayDate();return a===v?-1:i===v?1:new Date(i).getTime()-new Date(a).getTime()}).map(a=>({date:a,payments:o[a]})),console.log("Grouped Payments:",this.groupedPayments)}groupOrdersByDate(){const o={};this.orders.forEach(a=>{const i=a.orderDate;o[i]||(o[i]=[]),o[i].push(a)}),this.groupedOrders=Object.keys(o).sort((a,i)=>a===g?-1:i===g?1:new Date(i).getTime()-new Date(a).getTime()).map(a=>({date:a,orders:o[a]})),this.groupedOrders=Object.keys(o).sort((a,i)=>a===g?-1:i===g?1:new Date(i).getTime()-new Date(a).getTime()).map(a=>({date:a,orders:o[a]}))}formatDate(o){if(o===(new Date).toISOString().split("T")[0])return"Today";{const i={day:"numeric",month:"short"};return new Date(o).toLocaleDateString("en-US",i)}}isWork(){this.alertController.create({header:"Success",message:"It works!",buttons:["OK"]}).then(o=>o.present())}reOrder(o){const a=this.orders.find(i=>i.orderId===o);if(a){const i={orderId:this.generateOrderId(),restaurantName:a.restaurantName,restaurantLogo:a.restaurantLogo,orderStatus:"Pending",orderDate:this.getTodayDate(),deliveryTime:this.getCurrentTime(),totalAmount:a.totalAmount,DisountTotalAmount:a.DisountTotalAmount,items:a.items};this.orders.push(i),this.groupOrdersByDate(),this.alertController.create({header:"Order Again",message:"The order has been added to your orders.",buttons:["OK"]}).then(v=>v.present())}else this.alertController.create({header:"Error",message:"Order not found.",buttons:["OK"]}).then(i=>i.present())}generateOrderId(){return Math.floor(1e5*Math.random()).toString()}getTodayDate(){return(new Date).toISOString().split("T")[0]}getCurrentTime(){return(new Date).toLocaleTimeString("en-US",{hour:"numeric",minute:"numeric",hour12:!0})}}return(n=t).\u0275fac=function(o){return new(o||n)(s.rXU(e.hG),s.rXU(x))},n.\u0275cmp=s.VBU({type:n,selectors:[["app-orders"]],decls:9,vars:1,consts:[["slot","start"],[1,"header-margin-Single-Line"],[1,"titleFont"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[1,"MakeItFlexAsAColumn"],[1,"full","fiveMargin"],[1,"bodyFont","boldFont"],["class","card",4,"ngFor","ngForOf"],[1,"card"],["id","firstLine",1,"FlexSpaceInBetween","MakeItFlex"],[1,"status",3,"ngClass"],[1,"smallFont"],[1,"MakeItFlex","full"],[1,"SecondLine","FlexSpaceInBetween"],[1,"MakeItFlexAsAColumnNoCenter","details"],[1,"bodyFont","boldFont","smallFont"],["id","Total",1,"bodyFont","smallFont"],["id","YouPaid",1,"bodyFont","smallFont","boldFont"],[1,"MakeItFlexAsAColumnNoCenter","buttons"],["id","items",1,"bodyFont","smallFont"]],template:function(o,a){1&o&&(s.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),s.nrm(3,"ion-back-button"),s.k0s(),s.j41(4,"div",1)(5,"ion-label",2),s.EFF(6,"Orders"),s.k0s()()()(),s.j41(7,"ion-content",3),s.DNE(8,z,6,2,"div",4),s.k0s()),2&o&&(s.R7$(8),s.Y8G("ngForOf",a.groupedPayments))},dependencies:[w.YU,w.Sq,e.QW,e.W9,e.eU,e.he,e.ai,e.el],styles:["ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.icon[_ngcontent-%COMP%]{width:24px;height:auto}.fiveMargin[_ngcontent-%COMP%]{text-align:start;margin-bottom:10px!important}.full[_ngcontent-%COMP%]{max-width:350px;width:100%}.card[_ngcontent-%COMP%]{width:100%;max-width:350px;background-color:var(--GrayColor);border-radius:16px;padding:16px 16px 5px;margin-bottom:20px}#firstLine[_ngcontent-%COMP%]{margin-bottom:5px}.status[_ngcontent-%COMP%]{padding:10px;border-radius:16px;font-family:Montserrat,sans-serif;font-optical-sizing:auto;font-size:.875rem;font-weight:500;font-style:normal}.delivered[_ngcontent-%COMP%]{background-color:var(--GrayColor);border:1px solid var(--Black)}.not-delivered[_ngcontent-%COMP%]{background-color:var(--Accent-One);color:var(--GrayColor)}.square[_ngcontent-%COMP%]{width:50px;height:50px;margin-right:10px}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]{width:50px;height:50px;position:relative;border-radius:50%;overflow:hidden}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;object-fit:cover}.SecondLine[_ngcontent-%COMP%]{margin-left:10px;width:100%}.details[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-top:3px}.buttons[_ngcontent-%COMP%]{align-items:end}.buttons[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{margin:10px 0 0;width:70px;font-family:Montserrat;font-optical-sizing:auto;font-weight:400;font-size:.7rem;font-style:normal;text-align:center;border-radius:16px;background-color:var(--Main-Two);color:var(--White)}#items[_ngcontent-%COMP%]{margin-right:15px}#viewDetails[_ngcontent-%COMP%]{text-decoration:underline}#Total[_ngcontent-%COMP%]{text-decoration:line-through}#YouPaid[_ngcontent-%COMP%]{color:var(--Main-Two)!important}.orders[_ngcontent-%COMP%]{margin-bottom:11px;width:100%;background-color:var(--background-color);border-radius:16px;padding:16px}.singleOrder[_ngcontent-%COMP%]{padding:5px}"]}),t})()}];let f=(()=>{var n;class t{}return(n=t).\u0275fac=function(o){return new(o||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[d.iI.forChild(k),d.iI]}),t})(),B=(()=>{var n;class t{}return(n=t).\u0275fac=function(o){return new(o||n)},n.\u0275mod=s.$C({type:n}),n.\u0275inj=s.G2t({imports:[w.MD,m.YN,e.bv,f]}),t})()}}]);
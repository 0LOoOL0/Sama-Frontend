"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1804],{1804:(R,v,s)=>{s.r(v),s.d(v,{BookappointmentPageModule:()=>O});var p=s(9351),d=s(7199),r=s(7473),m=s(4170),g=s(5841),e=s(315),h=s(8525),f=s(990),b=s(5110),k=s(5822),F=s(1572);const y=(i,l)=>({"--background":i,"--color":l});function P(i,l){if(1&i){const a=e.RV6();e.j41(0,"div",23)(1,"div",24)(2,"ion-avatar")(3,"img",25),e.bIt("click",function(){const o=e.eBV(a).$implicit,n=e.XpG();return e.Njj(n.selectPet(o.id))}),e.k0s()(),e.j41(4,"p",26),e.EFF(5),e.k0s()()()}if(2&i){const a=l.$implicit;e.R7$(3),e.FS9("alt",a.name),e.Y8G("src",a.image,e.B4B),e.R7$(2),e.JRh(a.name)}}function M(i,l){if(1&i){const a=e.RV6();e.j41(0,"ion-chip",27),e.bIt("click",function(){const o=e.eBV(a).$implicit,n=e.XpG();return e.Njj(n.selectTime(o))}),e.j41(1,"ion-label"),e.EFF(2),e.k0s()()}if(2&i){const a=l.$implicit,t=e.XpG();e.Y8G("ngStyle",e.l_i(2,y,t.selectedTime===a?"var(--Main-Two)":"var(--White)",t.selectedTime===a?"white":"black")),e.R7$(2),e.JRh(a)}}const C=[{path:"",component:(()=>{var i;class l{constructor(t,o,n,c,u,S,x,B){this.activatedRoute=t,this.providerService=o,this.reminderService=n,this.navCtrl=c,this.fb=u,this.toastController=S,this.authService=x,this.petInfoService=B,this.pets=[],this.selectedMonth="",this.selectedDate="",this.availability=[],this.selectedTime=null,this.minDate=(new Date).toISOString(),this.maxDate=new Date((new Date).setFullYear((new Date).getFullYear()+1)).toISOString(),this.timeSlots=["09:00","09:30","10:00","10:30","11:00","11:30","15:00","15:30","16:00","16:30","17:00","17:30"],this.days=[{name:"M",key:"mon",available:!1},{name:"T",key:"tue",available:!1},{name:"W",key:"wed",available:!1},{name:"T",key:"thu",available:!1},{name:"F",key:"fri",available:!1},{name:"S",key:"sat",available:!1},{name:"S",key:"sun",available:!1}],this.specialNote="",this.petOwnerId=0,this.reminderForm=this.fb.group({title:[this.activatedRoute.snapshot.paramMap.get("title"),d.k0.required],date:["",d.k0.required],time:["",d.k0.required],remind:[!1,d.k0.required],repeat:["Doesn't Repeat",d.k0.required],note:[""],pet_id:[null],provider_id:+this.activatedRoute.snapshot.paramMap.get("provider")})}ngOnInit(){var t=this;return(0,g.A)(function*(){t.providerId=+t.activatedRoute.snapshot.paramMap.get("provider");try{const o=yield t.authService.getProfile();t.petOwnerId=o.id,t.reminderForm.patchValue({pet_owner_id:t.petOwnerId})}catch(o){console.error("Error fetching profile data:",o)}t.petInfoService.fetchPets().then(o=>{t.pets=o,console.log("Pets data:",t.pets)}).catch(o=>{console.error("Error fetching pets data:",o)}),t.providerId&&t.loadProviderData(t.providerId)})()}selectPet(t){console.log(t),this.selectedPetId=t,this.reminderForm.patchValue({pet_id:t})}dateChanged(t){const n=t.detail.value.split("T")[0];this.reminderForm.patchValue({date:n}),this.selectedDate=n,console.log("Selected Date:",n)}loadProviderData(t){var o=this;return(0,g.A)(function*(){o.providerService.getProviderById(t).then(n=>{var c;o.provider=Array.isArray(n.data)?n.data[0]:n.data,null!==(c=o.provider)&&void 0!==c&&c.availability&&(o.availability=JSON.parse(o.provider.availability),o.updateAvailability())},n=>{console.error("Error fetching provider details:",n)})})()}updateAvailability(){this.days.forEach(t=>{t.available=this.availability.includes(t.key)})}selectTime(t){this.selectedTime=t,this.reminderForm.patchValue({time:t})}submitReminder(){var t=this;return(0,g.A)(function*(){if(console.log("Form Valid:",t.reminderForm.valid),console.log("Form Values:",t.reminderForm.value),console.log("Form Errors:",t.reminderForm.errors),t.reminderForm.valid){const o={...t.reminderForm.value,pet_owner_id:t.petOwnerId,date:t.selectedDate,time:t.selectedTime,note:t.reminderForm.value.note,pet_id:t.reminderForm.value.pet_id,title:t.reminderForm.value.title,provider_id:t.reminderForm.value.provider_id};console.log("Submitting reminder with data:",o);try{const n=yield t.reminderService.addReminder(o);console.log("Reminder submitted successfully:",n),yield(yield t.toastController.create({message:"Reminder booked successfully!",duration:2e3,position:"bottom",color:"success"})).present();const u={title:t.activatedRoute.snapshot.paramMap.get("title")||"",date:"",time:"",remind:!1,repeat:"Doesn't Repeat",note:"",pet_id:null,provider:+t.activatedRoute.snapshot.paramMap.get("provider")};t.reminderForm.reset(u),t.selectedDate="",t.selectedTime=null,t.specialNote=""}catch(n){console.error("Error submitting reminder:",n),yield(yield t.toastController.create({message:"Failed to book reminder. Please try again.",duration:2e3,position:"bottom",color:"danger"})).present()}}else console.warn("Form is invalid:",t.reminderForm.errors),yield(yield t.toastController.create({message:"Please fill in all required fields.",duration:2e3,position:"bottom",color:"warning"})).present()})()}}return(i=l).\u0275fac=function(t){return new(t||i)(e.rXU(m.nX),e.rXU(h.$),e.rXU(f.s),e.rXU(b.q9),e.rXU(d.ok),e.rXU(r.K_),e.rXU(k.u),e.rXU(F.d))},i.\u0275cmp=e.VBU({type:i,selectors:[["app-bookappointment"]],decls:41,vars:8,consts:[["slot","start"],["defaultHref","/"],[1,"header-margin-Single-Line"],[1,"titleFont"],[1,"ion-padding"],["lines","none",1,"profile-item"],["slot","start",1,"pfp"],["alt","Doctor Profile Image",3,"src"],[1,"profile-clumn"],[1,"bodyFont","boldFont","white-txt"],[1,"bodyFont","smallFont","white-txt"],[1,"bodyFont","boldFont"],[1,"Scrollable"],["class","pets",4,"ngFor","ngForOf"],[3,"ngSubmit","formGroup"],[1,"roundedInput","bodyFont","textGray"],["formControlName","note","placeholder","Write Here",1,"bodyFont"],[1,"MakeItCenter"],[1,"shadow"],["display-format","DD MMM YYYY","picker-format","DD MMM YYYY","formControlName","date","presentation","date",1,"bodyFont","custom-datetime",3,"ionChange","min","max"],[1,"time-slots"],["class","bodyFontNoColor",3,"ngStyle","click",4,"ngFor","ngForOf"],["expand","block","fill","clear","type","submit",1,"FilledButtons"],[1,"pets"],[1,"petProfileSection"],[3,"click","src","alt"],[1,"bodyFont"],[1,"bodyFontNoColor",3,"click","ngStyle"]],template:function(t,o){1&t&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"div",2)(5,"ion-title",3),e.EFF(6,"Book Appointment"),e.k0s()()()(),e.j41(7,"ion-content",4)(8,"ion-item",5)(9,"ion-avatar",6),e.nrm(10,"img",7),e.k0s(),e.j41(11,"div",8)(12,"ion-text",9),e.EFF(13),e.k0s(),e.nrm(14,"br"),e.j41(15,"ion-text",10),e.EFF(16),e.k0s()()(),e.nrm(17,"br"),e.j41(18,"div")(19,"ion-label",11),e.EFF(20,"Select Pet"),e.k0s(),e.j41(21,"div",12),e.DNE(22,P,6,3,"div",13),e.k0s()(),e.j41(23,"form",14),e.bIt("ngSubmit",function(){return o.submitReminder()}),e.j41(24,"ion-label",11),e.EFF(25,"Special Note"),e.k0s(),e.j41(26,"ion-item",15),e.nrm(27,"ion-textarea",16),e.k0s(),e.nrm(28,"br"),e.j41(29,"ion-label",11),e.EFF(30,"Select Date"),e.k0s(),e.j41(31,"div",17)(32,"div",18)(33,"ion-datetime",19),e.bIt("ionChange",function(c){return o.dateChanged(c)}),e.k0s()()(),e.nrm(34,"br"),e.j41(35,"ion-label",11),e.EFF(36,"Select Hour"),e.k0s(),e.j41(37,"div",20),e.DNE(38,M,3,5,"ion-chip",21),e.k0s(),e.j41(39,"ion-button",22),e.EFF(40,"Book Appointment"),e.k0s()()()),2&t&&(e.R7$(10),e.Y8G("src",(null==o.provider?null:o.provider.profile_image)||"assets/default-profile.png",e.B4B),e.R7$(3),e.JRh(null==o.provider?null:o.provider.name),e.R7$(3),e.JRh(null==o.provider?null:o.provider.address),e.R7$(6),e.Y8G("ngForOf",o.pets),e.R7$(),e.Y8G("formGroup",o.reminderForm),e.R7$(10),e.Y8G("min",o.minDate)("max",o.maxDate),e.R7$(5),e.Y8G("ngForOf",o.timeSlots))},dependencies:[p.Sq,p.B3,d.qT,d.BC,d.cb,r.mC,r.Jm,r.QW,r.ZB,r.W9,r.A9,r.eU,r.uz,r.he,r.IO,r.nc,r.BC,r.ai,r.Je,r.Gw,r.el,d.j4,d.JD],styles:["ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.profile-item[_ngcontent-%COMP%]{--background: var(--Main-Two);border-radius:16px;width:100%}.pfp[_ngcontent-%COMP%]{width:50px;height:50px;margin:10px}.white-txt[_ngcontent-%COMP%]{color:var(--White)!important}.Scrollable[_ngcontent-%COMP%]{display:flex;align-items:flex-start;overflow:auto;margin-top:11px}.pets[_ngcontent-%COMP%]{display:flex}.petProfileSection[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;margin-right:10px}.petProfileSection[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.petProfileSection[_ngcontent-%COMP%]   ion-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50px;height:50px}.petProfileSection[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:0}.custom-datetime[_ngcontent-%COMP%]{--background: var(--White);border-radius:16px}.custom-datetime[_ngcontent-%COMP%]::part(active){background-color:var(--Main-Two);color:var(--White);border:1px solid var(--Main-Two)}.ion-picker-column-option[_ngcontent-%COMP%]{--highlight-background:var(--White);--highlight-border-radius:var(--Main-Two)}.shadow[_ngcontent-%COMP%]{max-width:350px;box-shadow:0 4px 8px #0000001a;border-radius:16px;margin-top:10px}.ion-color-primary[_ngcontent-%COMP%]{--ion-color-base: var(--Main-One) !important}.time-slots[_ngcontent-%COMP%]{display:flex;justify-content:center;flex-wrap:wrap;gap:10px;margin-top:10px}.time-slots[_ngcontent-%COMP%]   ion-chip[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:75px}.FilledButtons[_ngcontent-%COMP%]{background-color:var(--Main-Two)}ion-card[_ngcontent-%COMP%]{margin-bottom:20px}.time-slots[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-bottom:20px}ion-chip[_ngcontent-%COMP%]{--background: var(--ion-color-light)}ion-chip[color=primary][_ngcontent-%COMP%]{--background: var(--ion-color-primary);--color: #fff}"]}),l})()}];let _=(()=>{var i;class l{}return(i=l).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[m.iI.forChild(C),m.iI]}),l})(),O=(()=>{var i;class l{}return(i=l).\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.$C({type:i}),i.\u0275inj=e.G2t({imports:[p.MD,d.YN,r.bv,_,d.X1]}),l})()}}]);
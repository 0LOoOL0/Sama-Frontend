"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7710],{7710:(A,F,c)=>{c.r(F),c.d(F,{ProductDetailsPageModule:()=>U});var v=c(9351),n=c(7199),p=c(7473),P=c(4170),M=c(5841),t=c(315),_=c(1851),m=c(8525),R=c(5110),s=c(8454),e=c(5822),o=c(1301);const u=()=>[1,2,3,4,5],w=()=>["/cart"];function f(i,g){if(1&i&&t.nrm(0,"img",40),2&i){let l;const a=t.XpG();t.Y8G("src",null!==(l=a.selectedImage)&&void 0!==l?l:null==a.product||null==a.product.images?null:a.product.images[0],t.B4B)}}function $(i,g){if(1&i){const l=t.RV6();t.j41(0,"div",41),t.bIt("click",function(){const r=t.eBV(l).$implicit,d=t.XpG();return t.Njj(d.changeMainImage(r))}),t.nrm(1,"img",42),t.k0s()}if(2&i){const l=g.$implicit;t.R7$(),t.Y8G("src",l,t.B4B)}}function C(i,g){if(1&i&&(t.j41(0,"div",43),t.qSk(),t.j41(1,"svg",44),t.nrm(2,"path",45),t.k0s()()),2&i){const l=g.$implicit,a=t.XpG();t.R7$(),t.BMQ("fill",l<=a.averageRating?"#F0A441":"#9da4aa")}}function b(i,g){1&i&&(t.j41(0,"div",46)(1,"ion-label",15),t.EFF(2,"No review available"),t.k0s()())}function E(i,g){if(1&i&&(t.j41(0,"div",43),t.qSk(),t.j41(1,"svg",44),t.nrm(2,"path",45),t.k0s()()),2&i){const l=g.$implicit,a=t.XpG(2);t.R7$(),t.BMQ("fill",l<=a.reviews[0].rate?"#F0A441":"#9da4aa")}}function B(i,g){if(1&i&&(t.j41(0,"div")(1,"div",47)(2,"div",9)(3,"div",17)(4,"div",48)(5,"div",49),t.nrm(6,"img",50),t.k0s()(),t.j41(7,"div",11)(8,"ion-label",23),t.EFF(9),t.k0s(),t.j41(10,"div",18),t.DNE(11,E,3,1,"div",19),t.k0s()()(),t.j41(12,"ion-label",15),t.EFF(13),t.k0s()(),t.j41(14,"div",14)(15,"ion-label",15),t.EFF(16),t.k0s()()()()),2&i){const l=t.XpG();t.R7$(6),t.Y8G("src",null==l.reviews[0].petOwner?null:l.reviews[0].petOwner.profile_image,t.B4B),t.R7$(3),t.JRh(null==l.reviews[0].petOwner?null:l.reviews[0].petOwner.first_name),t.R7$(2),t.Y8G("ngForOf",t.lJ4(5,u)),t.R7$(2),t.JRh(l.reviews[0].date),t.R7$(3),t.JRh(l.reviews[0].comment)}}function O(i,g){if(1&i){const l=t.RV6();t.j41(0,"ion-button",51),t.bIt("click",function(){t.eBV(l);const r=t.XpG();return t.Njj(r.addToCart(r.product,r.quantity))}),t.EFF(1," Add to Cart "),t.k0s()}}const D=[{path:"",component:(()=>{var i;class g{constructor(a,r,d,h,k,y,I,j,x){this.activatedRoute=a,this.productService=r,this.providerService=d,this.navCtrl=h,this.cartService=k,this.authService=y,this.cdr=I,this.favService=j,this.toastController=x,this.reviews=[],this.averageRating=0,this.reviewCount=0,this.type="product",this.quantity=1,this.maxQuantity=10}ngOnInit(){this.productId=+this.activatedRoute.snapshot.paramMap.get("id"),this.productId&&(this.loadProduct(this.productId),this.loadReviews(this.productId))}loadProduct(a){var r=this;this.productService.getProductById(a).subscribe(function(){var d=(0,M.A)(function*(h){console.log("Product fetched successfully:",h),r.product={...h,images:h.images||[]},r.selectedImage=r.product.images[0],r.maxQuantity=h.quantity||10;const y=(yield r.authService.fetchProfileData()).id;r.cartService.isProductInCart(y,a).subscribe(I=>{r.product&&(r.product.isInCart=I,r.cdr.detectChanges())})});return function(h){return d.apply(this,arguments)}}(),d=>{console.error("Error fetching product:",d)})}increaseQuantity(){this.quantity<this.maxQuantity&&this.quantity++}decreaseQuantity(){this.quantity>1&&this.quantity--}loadReviews(a){var r=this;return(0,M.A)(function*(){try{const d=yield r.providerService.getProductReviewsByProductId(a);console.log("Reviews fetched successfully:",d.data),r.reviews=d.data;for(const y of r.reviews)if(y.pet_owner_id)try{const I=yield r.loadPetOwner(y.pet_owner_id);y.petOwner=I}catch(I){console.error("Error fetching pet owner for review:",I)}let h=0;const k=r.reviews.length;r.reviews.forEach(y=>{h+=y.rate}),r.averageRating=k>0?parseFloat((h/k).toFixed(2)):0,r.reviewCount=k}catch(d){console.error("Error fetching reviews:",d)}})()}loadPetOwner(a){return this.providerService.getPetOwnerById(a).then(r=>Array.isArray(r.data)?r.data[0]:r.data).catch(r=>{throw console.error("Error fetching pet owner details:",r),r})}changeMainImage(a){this.selectedImage=a}navigateToReviews(){this.navCtrl.navigateForward(`/review/${this.type}/${this.productId}`)}addToCart(a,r){this.cartService.toggleCartItem(a,r).then(()=>{this.presentToast("Product added to cart successfully!")}).catch(d=>{console.error("Error toggling cart item:",d)})}toggleFavorite(a){var r=this;return(0,M.A)(function*(){try{yield r.favService.toggleFavorite(a),r.cdr.detectChanges()}catch(d){console.error("Error toggling favorite:",d)}})()}presentToast(a){var r=this;return(0,M.A)(function*(){yield(yield r.toastController.create({message:a,duration:2e3,color:"success",position:"bottom"})).present()})()}}return(i=g).\u0275fac=function(a){return new(a||i)(t.rXU(P.nX),t.rXU(_.b),t.rXU(m.$),t.rXU(R.q9),t.rXU(s.m),t.rXU(e.u),t.rXU(t.gRc),t.rXU(o.L),t.rXU(p.K_))},i.\u0275cmp=t.VBU({type:i,selectors:[["app-product-details"]],decls:72,vars:19,consts:[["noReview",""],["slot","start"],[1,"header-margin-Single-Line"],[1,"titleFont"],[1,"ion-padding"],["alt","Product Image","class","Pimage",3,"src",4,"ngIf"],[1,"Scrollable"],[1,"MakeItFlexAtTheStart"],["class","ProductImgs",3,"click",4,"ngFor","ngForOf"],[1,"FlexSpaceInBetween"],[1,"blackTitleFont"],[1,"column"],["id","old-price",1,"bodyFont"],["id","new-price",1,"bodyFont","boldFont"],[1,"Margin-Top"],[1,"bodyFont"],[1,"FlexSpaceInBetween","Margin-Top"],[1,"MakeItFlex"],[1,"stars-container"],["class","star",4,"ngFor","ngForOf"],[1,"bodyFont","Rating"],[1,"MakeItCenter","column","qt-name"],[1,"MakeItCenter"],[1,"bodyFont","boldFont"],[1,"MakeItFlex","MakeItCenter","qt-buttons"],["src","/assets/icons/add-Minus.svg","alt","minus",1,"icon",3,"click"],[1,"bodyFont","Middle"],["src","/assets/icons/add-plus.svg","alt","plus",1,"icon",3,"click"],[1,"subscribe",2,"background-image","url('/assets/bg.svg')"],["fill","clear","routerLink","/subscription"],[1,"FlexSpaceInBetween","MakeItFlex"],["src","assets/icons/Star.svg",1,"icon","Middle"],[1,"bodyFont","boldFont","countColour"],[1,"bodyFont","boldFont",3,"click"],[4,"ngIf","ngIfElse"],[1,"footer","FlexSpaceInBetween"],["src","assets/icons/share1.svg",1,"icon"],["src","assets/icons/bag.svg",1,"icon","Middle",3,"routerLink"],["alt","Favorite Icon",1,"icon",3,"click","src"],["class","FilledButtons add-to-cart-button","fill","clear",3,"click",4,"ngIf"],["alt","Product Image",1,"Pimage",3,"src"],[1,"ProductImgs",3,"click"],[3,"src"],[1,"star"],["viewBox","0 0 1024 1024","xmlns","http://www.w3.org/2000/svg","stroke","rgba(0, 0, 0, 0.3)",1,"icon"],["d","M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"],[1,"noReview","Margin-Top"],[1,"ReviewContainer"],[1,"square"],[1,"parent"],["alt","Avatar",3,"src"],["fill","clear",1,"FilledButtons","add-to-cart-button",3,"click"]],template:function(a,r){if(1&a){const d=t.RV6();t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),t.nrm(3,"ion-back-button"),t.k0s(),t.j41(4,"div",2)(5,"ion-title",3),t.EFF(6,"Product Detail"),t.k0s()()()(),t.j41(7,"ion-content",4),t.DNE(8,f,1,1,"img",5),t.j41(9,"div",6)(10,"div",7),t.DNE(11,$,2,1,"div",8),t.k0s()(),t.nrm(12,"br"),t.j41(13,"div",9)(14,"ion-label",10),t.EFF(15),t.k0s(),t.j41(16,"div",11)(17,"ion-label",12),t.EFF(18),t.k0s(),t.j41(19,"ion-label",13),t.EFF(20),t.k0s()()(),t.j41(21,"div",14)(22,"ion-label",15),t.EFF(23),t.k0s()(),t.j41(24,"div",16)(25,"div",17)(26,"div",18),t.DNE(27,C,3,1,"div",19),t.k0s(),t.j41(28,"ion-label",20),t.EFF(29),t.k0s()(),t.j41(30,"div",21)(31,"div",22)(32,"ion-label",23),t.EFF(33,"Quantity"),t.k0s()(),t.j41(34,"div",24)(35,"img",25),t.bIt("click",function(){return t.eBV(d),t.Njj(r.decreaseQuantity())}),t.k0s(),t.j41(36,"ion-label",26),t.EFF(37),t.k0s(),t.j41(38,"img",27),t.bIt("click",function(){return t.eBV(d),t.Njj(r.increaseQuantity())}),t.k0s()()()(),t.nrm(39,"br"),t.j41(40,"div",22)(41,"div",28)(42,"div")(43,"ion-label",23),t.EFF(44,"For exclusive discounts,"),t.k0s(),t.nrm(45,"br"),t.j41(46,"ion-label",23),t.EFF(47,"Be a member?"),t.k0s()(),t.j41(48,"ion-button",29),t.EFF(49,"SUBSCRIBE"),t.k0s()()(),t.nrm(50,"br"),t.j41(51,"div",30)(52,"div",17)(53,"ion-label",23),t.EFF(54,"Reviews"),t.k0s(),t.nrm(55,"img",31),t.j41(56,"div")(57,"ion-label",23),t.EFF(58),t.k0s(),t.j41(59,"ion-label",32),t.EFF(60),t.k0s()()(),t.j41(61,"ion-label",33),t.bIt("click",function(){return t.eBV(d),t.Njj(r.navigateToReviews())}),t.EFF(62,"View All"),t.k0s()(),t.DNE(63,b,3,0,"ng-template",null,0,t.C5r)(65,B,17,6,"div",34),t.k0s(),t.j41(66,"div",35)(67,"div",17),t.nrm(68,"img",36)(69,"img",37),t.j41(70,"img",38),t.bIt("click",function(){return t.eBV(d),t.Njj(r.product&&r.toggleFavorite(r.product))}),t.k0s()(),t.DNE(71,O,2,0,"ion-button",39),t.k0s()}if(2&a){const d=t.sdS(64);t.R7$(8),t.Y8G("ngIf",null==r.product||null==r.product.images?null:r.product.images.length),t.R7$(3),t.Y8G("ngForOf",null==r.product?null:r.product.images),t.R7$(4),t.JRh(null==r.product?null:r.product.name),t.R7$(3),t.SpI("",null==r.product?null:r.product.old_price,"BHD"),t.R7$(2),t.SpI("",null==r.product?null:r.product.new_price,"BHD"),t.R7$(3),t.JRh(null==r.product?null:r.product.description),t.R7$(4),t.Y8G("ngForOf",t.lJ4(17,u)),t.R7$(2),t.Lme("",r.averageRating.toFixed(2)," | ",null==r.product?null:r.product.quantity," sold"),t.R7$(8),t.SpI(" ",r.quantity," "),t.R7$(21),t.JRh(r.averageRating.toFixed(2)),t.R7$(2),t.SpI("(",r.reviewCount,")"),t.R7$(5),t.Y8G("ngIf",r.reviews&&r.reviews.length>0)("ngIfElse",d),t.R7$(4),t.Y8G("routerLink",t.lJ4(18,w)),t.R7$(),t.Y8G("src",null!=r.product&&r.product.isFavorite?"assets/icons/heart.svg":"assets/heartr.svg",t.B4B),t.R7$(),t.Y8G("ngIf",r.product)}},dependencies:[v.Sq,v.bT,p.Jm,p.QW,p.W9,p.eU,p.he,p.BC,p.ai,p.el,p.N7,P.Wk],styles:["ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.blackTitleFont[_ngcontent-%COMP%]{font-size:1.2rem}.icon[_ngcontent-%COMP%]{width:24px;height:auto}.column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.Margin-Top[_ngcontent-%COMP%]{margin-top:10px}.Middle[_ngcontent-%COMP%]{margin-left:5px;margin-right:5px}.Pimage[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;width:80%;max-width:360px;height:auto;border-radius:16px}.Scrollable[_ngcontent-%COMP%]{display:flex;align-items:flex-start;overflow:auto;margin-top:10px}.MakeItFlexAtTheStart[_ngcontent-%COMP%]{display:flex}.ProductImgs[_ngcontent-%COMP%]{margin-right:5px;width:100%;min-width:75px;max-width:125px;height:100%;min-height:75px;max-height:125px;position:relative;overflow:hidden}.ProductImgs[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;object-fit:cover;object-position:center}#old-price[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--Main-One)!important;margin-right:10px;font-size:1rem!important}#new-price[_ngcontent-%COMP%]{color:var(--Main-Two)!important;font-size:1rem!important}.qt-name[_ngcontent-%COMP%]{width:30%}.qt-buttons[_ngcontent-%COMP%]{margin-top:5px;width:100%}.stars-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:3px}.star[_ngcontent-%COMP%]{margin-right:3px}.subscribe[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;width:100%;max-width:350px;height:64px;border-radius:16px;padding-right:20px;padding-left:20px;text-align:center}.subscribe[_ngcontent-%COMP%]   .bodyFont[_ngcontent-%COMP%]{color:var(--White)!important}.subscribe[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-family:Montserrat;font-optical-sizing:auto;font-style:normal;text-align:center;border-radius:16px;background-color:var(--Main-One);color:#fff;padding:0 16px}.countColour[_ngcontent-%COMP%]{color:var(--Main-One)!important;margin-left:3px}.noReview[_ngcontent-%COMP%]{width:100%}.ReviewContainer[_ngcontent-%COMP%]{width:100%;border-radius:16px;margin:10px 0;padding:16px}.square[_ngcontent-%COMP%]{width:50px;height:50px;margin-right:5px}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]{width:50px;height:50px;position:relative;border-radius:50%;overflow:hidden}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background-size:cover;background-position:center}.add-to-cart-button[_ngcontent-%COMP%]{width:50%;background-color:var(--Main-Two)}.footer[_ngcontent-%COMP%]{padding:0 16px}@media screen and (max-width: 350px){.subscribe[_ngcontent-%COMP%]   .bodyFont[_ngcontent-%COMP%]{font-size:.775rem}ion-button[_ngcontent-%COMP%]{padding:0 8px;width:50%}}"]}),g})()}];let S=(()=>{var i;class g{}return(i=g).\u0275fac=function(a){return new(a||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[P.iI.forChild(D),P.iI]}),g})(),U=(()=>{var i;class g{}return(i=g).\u0275fac=function(a){return new(a||i)},i.\u0275mod=t.$C({type:i}),i.\u0275inj=t.G2t({imports:[v.MD,n.YN,p.bv,S]}),g})()},5822:(A,F,c)=>{c.d(F,{u:()=>t});var v=c(5841),n=c(496),p=c(878),P=c(315),M=c(6e3);n.A.defaults.withCredentials=!0;let t=(()=>{var _;class m{constructor(s){this.http=s,this.apiUrl=p.c.apiUrl}getCSRFToken(){return n.A.get(`${this.apiUrl}/sanctum/csrf-cookie`)}register(s){var e=this;return(0,v.A)(function*(){return yield e.getCSRFToken(),n.A.post(`${e.apiUrl}/api/register`,s).then(o=>(localStorage.setItem("token",o.data.token),o.data)).catch(o=>{throw console.error("Login error:",o),o})})()}checkEmail(s){return n.A.post(`${this.apiUrl}/api/check-email`,{email:s})}sendVerificationCode(s){return n.A.post(`${this.apiUrl}/api/send-verification-code`,{email:s})}verifyCode(s){return n.A.post(`${this.apiUrl}/api/verify-code`,s)}login(s){var e=this;return(0,v.A)(function*(){return yield e.getCSRFToken(),n.A.post(`${e.apiUrl}/api/login`,s).then(o=>(localStorage.setItem("token",o.data.token),o.data)).catch(o=>{throw console.error("Login error:",o),o})})()}logout(){const s=localStorage.getItem("token");return n.A.post(`${this.apiUrl}/api/logout`,{},{headers:{Authorization:`Bearer ${s}`}}).then(()=>{localStorage.removeItem("token")})}getProfile(){var s=this;return(0,v.A)(function*(){const e=localStorage.getItem("token");return(yield n.A.get(`${s.apiUrl}/api/petOwner/profile`,{headers:{Authorization:`Bearer ${e}`}})).data.data})()}fetchProfileData(){var s=this;return(0,v.A)(function*(){try{const e=yield s.getProfile();return console.log("Profile response:",e),e}catch(e){throw console.error("Error fetching profile:",e),e}})()}getPetOwnerData(s){const e=localStorage.getItem("token");return n.A.get(`${this.apiUrl}/api/pet_owner/${s}`,{headers:{Authorization:`Bearer ${e}`}})}fetchPetOwnerData(s){return console.log("th id in auth=====>",s),this.getPetOwnerData(s).then(e=>(console.log("pet owner data:",e),e.data.data)).catch(e=>{throw console.error("Error fetching pet owner:",e),e})}updateProfile(s,e){const o=localStorage.getItem("token");return n.A.put(`${this.apiUrl}/api/pet_owner/${e}`,s,{headers:{Authorization:`Bearer ${o}`}})}updateProfileImage(s,e){const o=localStorage.getItem("token");return n.A.post(`${this.apiUrl}/api/pet_owner/image/${e}`,s,{headers:{Authorization:`Bearer ${o}`}})}updatePass(s,e,o){var u=this;return(0,v.A)(function*(){const w=localStorage.getItem("token");try{return(yield n.A.put(`${u.apiUrl}/api/pet-owners/update-password`,{email:s,password:e,password_confirmation:o},{headers:{Authorization:`Bearer ${w}`}})).data}catch(f){throw console.error("Error updating password:",f),f}})()}}return(_=m).\u0275fac=function(s){return new(s||_)(P.KVO(M.Qq))},_.\u0275prov=P.jDH({token:_,factory:_.\u0275fac,providedIn:"root"}),m})()},8525:(A,F,c)=>{c.d(F,{$:()=>_});var v=c(5841),n=c(496),p=c(878),P=c(5109),M=c(6200),t=c(315);n.A.defaults.withCredentials=!0;let _=(()=>{var m;class R{constructor(){this.apiUrl=`${p.c.apiUrl}/api`,n.A.interceptors.request.use(e=>{const o=localStorage.getItem("token");return o&&(e.headers.Authorization=`Bearer ${o}`),e},e=>Promise.reject(e))}getAllProviders(){return n.A.get(`${this.apiUrl}/providers`)}getProviderById(e){return n.A.get(`${this.apiUrl}/providers/${e}`)}getProviderById2(e){return(0,P.H)(n.A.get(`${this.apiUrl}/providers/${e}`)).pipe((0,M.T)(o=>o.data))}createProvider(e){return n.A.post(`${this.apiUrl}/providers`,e)}getAllProviders2(){var e=this;return(0,v.A)(function*(){return n.A.get(`${e.apiUrl}/providers`).then(o=>o.data)})()}updateProvider(e,o){return n.A.put(`${this.apiUrl}/providers/${e}`,o)}deleteProvider(e){return n.A.delete(`${this.apiUrl}/providers/${e}`)}getServicesByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/services`)}getProductsByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/products`)}getVeterinariansByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/veterinarians`)}getVeterianById(e){return n.A.get(`${this.apiUrl}/veterinarians/${e}`)}getServiceById(e){return n.A.get(`${this.apiUrl}/services/${e}`)}getProductById(e){return n.A.get(`${this.apiUrl}/products/${e}`)}getServiceReviewsByServiceId(e){return n.A.get(`${this.apiUrl}/services/${e}/reviews`)}getPetOwnerById(e){return n.A.get(`${this.apiUrl}/pet_owners/${e}`)}getProductReviewsByProductId(e){return n.A.get(`${this.apiUrl}/products/${e}/reviews`)}getProviderByName(e){return(0,P.H)(n.A.get(`${this.apiUrl}/providers/name/${e}`))}addReview(e){var o=this;return(0,v.A)(function*(){try{console.log("Review data before sending:",e);const u=yield n.A.post(`${o.apiUrl}/reviews`,e);return console.log("Server response:",u.data),u.data}catch(u){throw console.error("Error adding review:",u),u}})()}getAverageRatingByProviderId(e){var o=this;return(0,v.A)(function*(){try{const w=(yield o.getServicesByProviderId(e)).data;let f=0,$=0;for(const b of w)(yield o.getServiceReviewsByServiceId(b.id)).data.forEach(O=>{$+=O.rate,f++});return f>0?$/f:0}catch(u){throw console.error("Error calculating average rating:",u),u}})()}getAverageRatingByProductId(e){var o=this;return(0,v.A)(function*(){try{const w=(yield n.A.get(`${o.apiUrl}/products/${e}/reviews`)).data;return 0===w.length?null:w.reduce(($,C)=>$+C.rate,0)/w.length}catch(u){throw console.error("Error fetching reviews:",u),u}})()}}return(m=R).\u0275fac=function(e){return new(e||m)},m.\u0275prov=t.jDH({token:m,factory:m.\u0275fac,providedIn:"root"}),R})()}}]);
"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2659],{2659:(O,B,a)=>{a.r(B),a.d(B,{FavoritePageModule:()=>T});var v=a(9351),n=a(7199),m=a(7473),$=a(4170),U=a(5841),I=a(8580),r=a(315),u=a(1301),S=a(1851),s=a(5109),e=a(878),t=a(496),i=a(6200),g=a(6e3);let _=(()=>{var c;class A{constructor(o){this.http=o,this.apiUrl=`${e.c.apiUrl}/api`,t.A.interceptors.request.use(d=>{const h=localStorage.getItem("token");return h&&(d.headers.Authorization=`Bearer ${h}`),d},d=>Promise.reject(d))}getServices(){return(0,s.H)(t.A.get(`${this.apiUrl}/services`)).pipe((0,i.T)(o=>o.data))}getServiceById(o){return(0,s.H)(t.A.get(`${this.apiUrl}/services/${o}`)).pipe((0,i.T)(d=>d.data))}getServicesByProviderId(o){return(0,s.H)(t.A.get(`${this.apiUrl}/services/providers/${o}/services`)).pipe((0,i.T)(d=>d.data))}}return(c=A).\u0275fac=function(o){return new(o||c)(r.KVO(g.Qq))},c.\u0275prov=r.jDH({token:c,factory:c.\u0275fac,providedIn:"root"}),A})();var E=a(5822),k=a(8525),C=a(1572);function D(c,A){if(1&c){const P=r.RV6();r.j41(0,"div",9),r.bIt("click",function(){const d=r.eBV(P).$implicit,h=r.XpG();return r.Njj(h.navigateToDetails(d))}),r.j41(1,"div",10),r.nrm(2,"img",11),r.k0s(),r.j41(3,"div",12)(4,"div",13)(5,"ion-label",14),r.EFF(6),r.k0s()(),r.j41(7,"img",15),r.bIt("click",function(d){const h=r.eBV(P).$implicit;return r.XpG().toggleFavorite(h),r.Njj(d.stopPropagation())}),r.k0s()()()}if(2&c){const P=A.$implicit;r.R7$(2),r.FS9("alt",P.name),r.Y8G("src",P.image,r.B4B),r.R7$(4),r.JRh(P.name)}}const M=[{path:"",component:(()=>{var c;class A{constructor(o,d,h,f,p,l,y,F){this.favService=o,this.productService=d,this.serviceService=h,this.router=f,this.toastController=p,this.authService=l,this.providerService=y,this.petService=F,this.items=[]}ngOnInit(){this.loadFavorites()}loadFavorites(){var o=this;return(0,U.A)(function*(){try{const h=(yield o.authService.fetchProfileData()).id;o.favService.getFavsByPetOwnerId(h).subscribe(f=>{f.forEach(p=>{p.product_id?o.productService.getProductById(p.product_id).subscribe(l=>{l?o.items.push({id:p.id,product_id:p.product_id,name:l.name,image:l.images[0],isFavorite:!0}):console.error("Product not found for id:",p.product_id)},l=>console.error("Error fetching product:",l)):p.service_id?o.serviceService.getServiceById(p.service_id).subscribe(l=>{l?o.items.push({id:p.id,service_id:p.service_id,name:l.title,image:l.image,isFavorite:!0}):console.error("Service not found for id:",p.service_id)},l=>console.error("Error fetching service:",l)):p.provider_id?o.providerService.getProviderById(p.provider_id).then(l=>{const y=l.data;if(Array.isArray(y)&&y.length>0){const F=y[0];o.items.push({id:p.id,provider_id:p.provider_id,name:F.name,image:F.profile_image,isFavorite:!0})}else console.error("Provider not found or array invalid:",y)},l=>console.error("Error fetching provider:",l)):p.pet_id&&o.petService.getPetById(p.pet_id).subscribe(l=>{let y=Array.isArray(l)?l[0]:l;y&&y.id?(o.items.push({id:p.id,pet_id:p.pet_id,name:y.name,image:y.image,isFavorite:!0}),console.log("Pet loaded:",o.items[o.items.length-1])):console.error("Pet not found or invalid:",l)},l=>console.error("Error fetching pet:",l))}),console.log("Favorites loaded:",o.items)},f=>{console.error("Error fetching favorites:",f)})}catch(d){console.error("Error loading profile or favorites:",d)}})()}toggleFavorite(o){var d=this;return(0,U.A)(function*(){try{if(o.isFavorite)yield d.favService.deleteFav(o.id).toPromise(),o.isFavorite=!1,yield(0,I.P)(d.toastController,"Item removed from favorites","danger");else{const h={pet_owner_id:(yield d.authService.fetchProfileData()).id,product_id:o.product_id,service_id:o.service_id,provider_id:o.provider_id},f=yield d.favService.createFav(h).toPromise();f?(o.id=f.id,o.isFavorite=!0,yield(0,I.P)(d.toastController,"Item added to favorites","success")):yield(0,I.P)(d.toastController,"Failed to add item to favorites","danger")}}catch(h){console.error("Error toggling favorite:",h),yield(0,I.P)(d.toastController,"Failed to update favorite status","danger")}})()}navigateToDetails(o){var d=this;return(0,U.A)(function*(){if(o.product_id)d.router.navigate(["/product-details",o.product_id]);else if(o.service_id)d.router.navigate(["/providerservice",o.service_id]);else if(o.provider_id)try{const f=(yield d.providerService.getProviderById(o.provider_id)).data;if(Array.isArray(f)&&f.length>0){const p=f[0];if(p&&p.type){const l=p.type.toLowerCase();switch(l){case"pet shop":d.router.navigate(["/vetdetails/petstores/",o.provider_id]);break;case"groomer":d.router.navigate(["/vetdetails/groomer",o.provider_id]);break;case"trainer":d.router.navigate(["/vetdetails/trainer/",o.provider_id]);break;case"doctor":d.router.navigate(["/vetdetails/doctor/",o.provider_id]);break;case"pet clinic":d.router.navigate(["/vetdetails/vetclinic/",o.provider_id]);break;default:console.error("Unknown provider type:",l)}}else console.error("Provider type is missing or invalid:",p)}else console.error("Provider array is empty or invalid:",f)}catch(h){console.error("Error fetching provider:",h)}})()}}return(c=A).\u0275fac=function(o){return new(o||c)(r.rXU(u.L),r.rXU(S.b),r.rXU(_),r.rXU($.Ix),r.rXU(m.K_),r.rXU(E.u),r.rXU(k.$),r.rXU(C.d))},c.\u0275cmp=r.VBU({type:c,selectors:[["app-favorite"]],decls:15,vars:1,consts:[["slot","start"],[1,"header-margin-Single-Line"],[1,"titleFont"],["slot","end"],["src","assets/icons/filter.svg",1,"icon"],[1,"ion-padding"],[1,"MakeItCenter"],[1,"MakeItAGride","favoriteContainer"],["class","product-item",3,"click",4,"ngFor","ngForOf"],[1,"product-item",3,"click"],[1,"imgContainer"],[3,"src","alt"],[1,"FlexSpaceInBetween"],[1,"titleContainer"],[1,"bodyFont","boldFont","vetClinicTitle"],["src","assets/heartr.svg",1,"icon",3,"click"]],template:function(o,d){1&o&&(r.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),r.nrm(3,"ion-back-button"),r.k0s(),r.j41(4,"div",1)(5,"ion-label",2),r.EFF(6,"Favorite"),r.k0s()(),r.j41(7,"ion-buttons",3)(8,"ion-button"),r.nrm(9,"img",4),r.k0s()()()(),r.j41(10,"ion-content",5)(11,"div",6)(12,"div")(13,"div",7),r.DNE(14,D,8,3,"div",8),r.k0s()()()()),2&o&&(r.R7$(14),r.Y8G("ngForOf",d.items))},dependencies:[v.Sq,m.Jm,m.QW,m.W9,m.eU,m.he,m.ai,m.el],styles:["ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.icon[_ngcontent-%COMP%]{width:24px;height:auto}.favoriteContainer[_ngcontent-%COMP%]{max-width:350px}.product-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin:5px;padding:10px;border-radius:16px;background-color:var(--White)}.imgContainer[_ngcontent-%COMP%]{width:100%;height:70%;margin-bottom:10px;border-radius:16px;position:relative;overflow:hidden}.imgContainer[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;border-radius:16px;height:auto;object-fit:cover;object-position:center}.titleContainer[_ngcontent-%COMP%]{width:80%}.vetClinicTitle[_ngcontent-%COMP%]{margin-bottom:3px}"]}),A})()}];let R=(()=>{var c;class A{}return(c=A).\u0275fac=function(o){return new(o||c)},c.\u0275mod=r.$C({type:c}),c.\u0275inj=r.G2t({imports:[$.iI.forChild(M),$.iI]}),A})(),T=(()=>{var c;class A{}return(c=A).\u0275fac=function(o){return new(o||c)},c.\u0275mod=r.$C({type:c}),c.\u0275inj=r.G2t({imports:[v.MD,n.YN,m.bv,R]}),A})()},5822:(O,B,a)=>{a.d(B,{u:()=>I});var v=a(5841),n=a(496),m=a(878),$=a(315),U=a(6e3);n.A.defaults.withCredentials=!0;let I=(()=>{var r;class u{constructor(s){this.http=s,this.apiUrl=m.c.apiUrl}getCSRFToken(){return n.A.get(`${this.apiUrl}/sanctum/csrf-cookie`)}register(s){var e=this;return(0,v.A)(function*(){return yield e.getCSRFToken(),n.A.post(`${e.apiUrl}/api/register`,s).then(t=>(localStorage.setItem("token",t.data.token),t.data)).catch(t=>{throw console.error("Login error:",t),t})})()}checkEmail(s){return n.A.post(`${this.apiUrl}/api/check-email`,{email:s})}sendVerificationCode(s){return n.A.post(`${this.apiUrl}/api/send-verification-code`,{email:s})}verifyCode(s){return n.A.post(`${this.apiUrl}/api/verify-code`,s)}login(s){var e=this;return(0,v.A)(function*(){return yield e.getCSRFToken(),n.A.post(`${e.apiUrl}/api/login`,s).then(t=>(localStorage.setItem("token",t.data.token),t.data)).catch(t=>{throw console.error("Login error:",t),t})})()}logout(){const s=localStorage.getItem("token");return n.A.post(`${this.apiUrl}/api/logout`,{},{headers:{Authorization:`Bearer ${s}`}}).then(()=>{localStorage.removeItem("token")})}getProfile(){var s=this;return(0,v.A)(function*(){const e=localStorage.getItem("token");return(yield n.A.get(`${s.apiUrl}/api/petOwner/profile`,{headers:{Authorization:`Bearer ${e}`}})).data.data})()}fetchProfileData(){var s=this;return(0,v.A)(function*(){try{const e=yield s.getProfile();return console.log("Profile response:",e),e}catch(e){throw console.error("Error fetching profile:",e),e}})()}getPetOwnerData(s){const e=localStorage.getItem("token");return n.A.get(`${this.apiUrl}/api/pet_owner/${s}`,{headers:{Authorization:`Bearer ${e}`}})}fetchPetOwnerData(s){return console.log("th id in auth=====>",s),this.getPetOwnerData(s).then(e=>(console.log("pet owner data:",e),e.data.data)).catch(e=>{throw console.error("Error fetching pet owner:",e),e})}updateProfile(s,e){const t=localStorage.getItem("token");return n.A.put(`${this.apiUrl}/api/pet_owner/${e}`,s,{headers:{Authorization:`Bearer ${t}`}})}updateProfileImage(s,e){const t=localStorage.getItem("token");return n.A.post(`${this.apiUrl}/api/pet_owner/image/${e}`,s,{headers:{Authorization:`Bearer ${t}`}})}updatePass(s,e,t){var i=this;return(0,v.A)(function*(){const g=localStorage.getItem("token");try{return(yield n.A.put(`${i.apiUrl}/api/pet-owners/update-password`,{email:s,password:e,password_confirmation:t},{headers:{Authorization:`Bearer ${g}`}})).data}catch(_){throw console.error("Error updating password:",_),_}})()}}return(r=u).\u0275fac=function(s){return new(s||r)($.KVO(U.Qq))},r.\u0275prov=$.jDH({token:r,factory:r.\u0275fac,providedIn:"root"}),u})()},1572:(O,B,a)=>{a.d(B,{d:()=>r});var v=a(496),n=a(5109),m=a(878),$=a(315),U=a(6e3),I=a(4003);let r=(()=>{var u;class S{constructor(e,t){this.http=e,this.storage=t,this.apiUrl=m.c.apiUrl,this.petId=null}addPet(e){for(const[i,g]of e.entries())console.log(`${i}: ${g}`);const t=localStorage.getItem("token");return v.A.post(`${this.apiUrl}/api/pet/store`,e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}})}getPets(){const e=localStorage.getItem("token");return v.A.get(`${this.apiUrl}/api/petOwner/pets`,{headers:{Authorization:`Bearer ${e}`}})}getPetsByOwnerId(e){const t=localStorage.getItem("token");return(0,n.H)(v.A.get(`${this.apiUrl}/api/pet_owners/${e}/pets`,{headers:{Authorization:`Bearer ${t}`}}).then(i=>(console.log("Pets by Owner ID response:",i),i.data.data)).catch(i=>{throw console.error("Error fetching pets by owner ID:",i),i}))}getPetById(e){const t=localStorage.getItem("token");return(0,n.H)(v.A.get(`${this.apiUrl}/api/pet/${e}`,{headers:{Authorization:`Bearer ${t}`}}).then(i=>(console.log("Pet response:",i),i.data.data)).catch(i=>{throw console.error("Error fetching pet:",i),i}))}getAllPets(){const e=localStorage.getItem("token");return v.A.get(`${this.apiUrl}/api/pets`,{headers:{Authorization:`Bearer ${e}`}})}fetchAllPets(){return this.getAllPets().then(e=>(console.log("All Pets response:",e),e.data.data)).catch(e=>{throw console.error("Error fetching all pets:",e),e})}fetchPets(){return this.getPets().then(e=>(console.log("Pets response:",e),e.data.data)).catch(e=>{throw console.error("Error fetching pets:",e),e})}getPet(e){return this.http.get(`${this.apiUrl}/api/pet/${e}`)}storePet(e){return this.http.post(`${this.apiUrl}/api/pet`,e)}updatePet(e,t){console.log("pet in pet-info.service====>",t);const i=localStorage.getItem("token");return v.A.post(`${this.apiUrl}/api/pet/update/${e}`,t,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"multipart/form-data"}})}updateLostStatus(e,t){const i=localStorage.getItem("token");return this.http.post(`${this.apiUrl}/api/pet/update-lost-status/${e}`,{is_lost:t?1:0},{headers:{Authorization:`Bearer ${i}`}})}updateAdoptionStatus(e,t){const i=localStorage.getItem("token");return this.http.post(`${this.apiUrl}/api/pet/update-adoption-status/${e}`,{allow_adoption:t?1:0},{headers:{Authorization:`Bearer ${i}`}})}updateMatingStatus(e,t){const i=localStorage.getItem("token"),_={is_neutered:t.toLowerCase()};return this.http.post(`${this.apiUrl}/api/pet/update-mating-status/${e}`,_,{headers:{Authorization:`Bearer ${i}`}})}deleteImage(e){const t=localStorage.getItem("token");return this.http.post(`${this.apiUrl}/api/pet/delete-image/${e}`,{},{headers:{Authorization:`Bearer ${t}`}})}updateImage(e,t){const i=localStorage.getItem("token");return this.http.post(`${this.apiUrl}/api/pet/update-image/${e}`,t,{headers:{Authorization:`Bearer ${i}`}})}deletePet(e){const t=localStorage.getItem("token");return this.http.delete(`${this.apiUrl}/api/pet/${e}`,{headers:{Authorization:`Bearer ${t}`}})}setPetId(e){this.petId=e}getPetId(){return this.petId}markPetAsLost(e){return this.http.post(`${this.apiUrl}/api/pet/lost/${e}`,{})}markPetAsFound(e){return this.http.post(`${this.apiUrl}/api/pet/found/${e}`,{})}getOwnerIdByEmail(e){return this.http.get(`${this.apiUrl}/api/petOwners/byEmail`,{params:{email:e}})}updatePetOwner(e,t){return this.http.put(`${this.apiUrl}/api/pets/${e}`,{pet_owner_id:t})}addDocument(e,t){const i=localStorage.getItem("token");return v.A.post(`${this.apiUrl}/api/pet/${e}/documents`,t,{headers:{Authorization:`Bearer ${i}`,"Content-Type":"multipart/form-data"}})}uploadImage(e){return this.storage.ref(e).getDownloadURL().toPromise()}addLostPetByFounder(e){const t=localStorage.getItem("token");return v.A.post(`${this.apiUrl}/api/addLostPetByFounder`,e,{headers:{Authorization:`Bearer ${t}`,"Content-Type":"multipart/form-data"}})}fetchAllLostPets(){const e=localStorage.getItem("token");return this.http.get(`${this.apiUrl}/api/allLostPets`,{headers:{Authorization:`Bearer ${e}`}})}showLostPetByFounder(e){const t=localStorage.getItem("token");return this.http.get(`${this.apiUrl}/api/showLostPetByFounder/${e}`,{headers:{Authorization:`Bearer ${t}`}})}deleteLostPetByFounder(e){const t=localStorage.getItem("token");return this.http.delete(`${this.apiUrl}/api/deleteLostPetByFounder/${e}`,{headers:{Authorization:`Bearer ${t}`}})}}return(u=S).\u0275fac=function(e){return new(e||u)($.KVO(U.Qq),$.KVO(I.ap))},u.\u0275prov=$.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),S})()},8525:(O,B,a)=>{a.d(B,{$:()=>r});var v=a(5841),n=a(496),m=a(878),$=a(5109),U=a(6200),I=a(315);n.A.defaults.withCredentials=!0;let r=(()=>{var u;class S{constructor(){this.apiUrl=`${m.c.apiUrl}/api`,n.A.interceptors.request.use(e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization=`Bearer ${t}`),e},e=>Promise.reject(e))}getAllProviders(){return n.A.get(`${this.apiUrl}/providers`)}getProviderById(e){return n.A.get(`${this.apiUrl}/providers/${e}`)}getProviderById2(e){return(0,$.H)(n.A.get(`${this.apiUrl}/providers/${e}`)).pipe((0,U.T)(t=>t.data))}createProvider(e){return n.A.post(`${this.apiUrl}/providers`,e)}getAllProviders2(){var e=this;return(0,v.A)(function*(){return n.A.get(`${e.apiUrl}/providers`).then(t=>t.data)})()}updateProvider(e,t){return n.A.put(`${this.apiUrl}/providers/${e}`,t)}deleteProvider(e){return n.A.delete(`${this.apiUrl}/providers/${e}`)}getServicesByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/services`)}getProductsByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/products`)}getVeterinariansByProviderId(e){return n.A.get(`${this.apiUrl}/providers/${e}/veterinarians`)}getVeterianById(e){return n.A.get(`${this.apiUrl}/veterinarians/${e}`)}getServiceById(e){return n.A.get(`${this.apiUrl}/services/${e}`)}getProductById(e){return n.A.get(`${this.apiUrl}/products/${e}`)}getServiceReviewsByServiceId(e){return n.A.get(`${this.apiUrl}/services/${e}/reviews`)}getPetOwnerById(e){return n.A.get(`${this.apiUrl}/pet_owners/${e}`)}getProductReviewsByProductId(e){return n.A.get(`${this.apiUrl}/products/${e}/reviews`)}getProviderByName(e){return(0,$.H)(n.A.get(`${this.apiUrl}/providers/name/${e}`))}addReview(e){var t=this;return(0,v.A)(function*(){try{console.log("Review data before sending:",e);const i=yield n.A.post(`${t.apiUrl}/reviews`,e);return console.log("Server response:",i.data),i.data}catch(i){throw console.error("Error adding review:",i),i}})()}getAverageRatingByProviderId(e){var t=this;return(0,v.A)(function*(){try{const g=(yield t.getServicesByProviderId(e)).data;let _=0,E=0;for(const C of g)(yield t.getServiceReviewsByServiceId(C.id)).data.forEach(M=>{E+=M.rate,_++});return _>0?E/_:0}catch(i){throw console.error("Error calculating average rating:",i),i}})()}getAverageRatingByProductId(e){var t=this;return(0,v.A)(function*(){try{const g=(yield n.A.get(`${t.apiUrl}/products/${e}/reviews`)).data;return 0===g.length?null:g.reduce((E,k)=>E+k.rate,0)/g.length}catch(i){throw console.error("Error fetching reviews:",i),i}})()}}return(u=S).\u0275fac=function(e){return new(e||u)},u.\u0275prov=I.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),S})()}}]);
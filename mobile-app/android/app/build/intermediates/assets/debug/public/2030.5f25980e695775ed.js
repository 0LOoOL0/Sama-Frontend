"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2030],{2030:(w,v,u)=>{u.r(v),u.d(v,{CartPageModule:()=>j});var h=u(9351),g=u(7199),l=u(7473),P=u(4170),m=u(5841),t=u(315),C=u(8454),b=u(1851),x=u(5822);const i=r=>["/check-out",r];function s(r,p){if(1&r){const a=t.RV6();t.j41(0,"ion-item-sliding")(1,"ion-item",13)(2,"div",14)(3,"ion-checkbox",15),t.mxI("ngModelChange",function(e){const o=t.eBV(a).$implicit;return t.DH7(o.selected,e)||(o.selected=e),t.Njj(e)}),t.bIt("ionChange",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.updatePageInfo())}),t.k0s(),t.nrm(4,"img",16),t.j41(5,"div",17)(6,"ion-label",18),t.EFF(7),t.k0s(),t.j41(8,"ion-label",19),t.EFF(9),t.nI1(10,"number"),t.k0s()()(),t.j41(11,"ion-buttons",20)(12,"ion-button",21),t.bIt("click",function(){const e=t.eBV(a).$implicit,o=t.XpG();return t.Njj(o.decrementQuantity(e))}),t.nrm(13,"img",22),t.k0s(),t.j41(14,"ion-input",23),t.mxI("ngModelChange",function(e){const o=t.eBV(a).$implicit;return t.DH7(o.quantity,e)||(o.quantity=e),t.Njj(e)}),t.bIt("ionChange",function(e){const o=t.eBV(a).$implicit,c=t.XpG();return t.Njj(c.onQuantityChange(o,e))}),t.k0s(),t.j41(15,"ion-button",21),t.bIt("click",function(){const e=t.eBV(a).$implicit,o=t.XpG();return t.Njj(o.incrementQuantity(e))}),t.nrm(16,"img",24),t.k0s()()(),t.j41(17,"ion-item-options",25)(18,"ion-item-option",26),t.bIt("click",function(){const e=t.eBV(a).$implicit,o=t.XpG();return t.Njj(o.deleteCartItem(e))}),t.nrm(19,"img",27),t.k0s()()()}if(2&r){const a=p.$implicit;t.R7$(3),t.R50("ngModel",a.selected),t.R7$(),t.Y8G("src",a.imageUrl,t.B4B),t.R7$(3),t.JRh(a.label),t.R7$(2),t.SpI("",t.i5U(10,8,a.price*a.quantity,"1.2-2")," BHD"),t.R7$(3),t.Y8G("disabled",a.quantity<=1),t.R7$(2),t.R50("ngModel",a.quantity),t.Y8G("max",a.maxQuantity),t.R7$(),t.Y8G("disabled",a.quantity>=a.maxQuantity)}}function d(r,p){if(1&r&&(t.j41(0,"div",17)(1,"ion-label",18),t.EFF(2,"Total:"),t.k0s(),t.j41(3,"ion-label",18),t.EFF(4),t.nI1(5,"number"),t.k0s(),t.j41(6,"ion-label",19),t.EFF(7),t.nI1(8,"number"),t.k0s()()),2&r){const a=t.XpG();t.R7$(4),t.SpI("",t.i5U(5,2,a.totalPrice,"1.2-2"),"BHD"),t.R7$(3),t.SpI("Saved: BHD ",t.i5U(8,5,a.savedPrice,"1.2-2"),"")}}function y(r,p){if(1&r&&(t.j41(0,"div",28)(1,"div",17)(2,"ion-label",18),t.EFF(3,"Total:"),t.k0s(),t.j41(4,"ion-label",18),t.EFF(5),t.nI1(6,"number"),t.k0s()()()),2&r){const a=t.XpG();t.R7$(5),t.SpI("",t.i5U(6,1,a.totalPrice,"1.2-2"),"BHD")}}function O(r,p){if(1&r){const a=t.RV6();t.j41(0,"ion-button",29),t.bIt("click",function(){t.eBV(a);const e=t.XpG();return t.Njj(e.deleteSelectedItems())}),t.nrm(1,"img",27),t.k0s()}}const F=[{path:"",component:(()=>{var r;class p{constructor(n,e,o,c){this.cartService=n,this.productService=e,this.authService=o,this.toastController=c,this.items=[],this.selectAll=!1,this.isMember=!1,this.discountRate=.1,this.totalPrice=0,this.savedPrice=0,this.selectedItemsCount=0}ngOnInit(){var n=this;return(0,m.A)(function*(){yield n.loadCartItems()})()}loadCartItems(){var n=this;return(0,m.A)(function*(){try{const o=(yield n.authService.fetchProfileData()).id,c=yield n.cartService.getCartsByPetOwnerId(o).toPromise();if(null==c||!c.length)return void(n.items=[]);const f=yield Promise.all(c.map(_=>n.getProduct(_.product_id)));n.items=n.mergeCartWithProducts(c,f),n.calculateTotal(),console.log("Cart items:",n.items)}catch(e){console.error("Error fetching cart items:",e)}})()}getProduct(n){var e=this;return(0,m.A)(function*(){return n?e.productService.getProductById(n).toPromise():null})()}mergeCartWithProducts(n,e){return n.map((o,c)=>{var f,_,I,k,A;return{...o,maxQuantity:(null===(f=e[c])||void 0===f?void 0:f.quantity)||10,imageUrl:(null===(_=e[c])||void 0===_||null===(_=_.images)||void 0===_?void 0:_[0])||"assets/default-image.png",label:(null===(I=e[c])||void 0===I?void 0:I.name)||"Unknown Product",price:this.isMember?null===(k=e[c])||void 0===k?void 0:k.new_price:null===(A=e[c])||void 0===A?void 0:A.old_price}})}selectAllItems(n){const e=n.detail.checked;this.items.forEach(o=>o.selected=e),this.selectAll=e,this.updatePageInfo()}updatePageInfo(){this.selectAll=this.items.every(n=>n.selected),this.updateSelectedItemsCount(),this.calculateTotal()}updateSelectedItemsCount(){this.selectedItemsCount=this.items.filter(n=>n.selected).length}calculateTotal(){const e=this.items.filter(o=>o.selected).reduce((o,c)=>o+c.price*c.quantity,0);console.log("Total Without Discount:",e),this.isMember?(this.totalPrice=e*(1-this.discountRate),this.savedPrice=e*this.discountRate):(this.totalPrice=e,this.savedPrice=0),console.log("Total Price:",this.totalPrice)}incrementQuantity(n){var e=this;return(0,m.A)(function*(){n.quantity<n.maxQuantity&&(n.quantity++,yield e.updateCartItem(n),e.calculateTotal())})()}decrementQuantity(n){var e=this;return(0,m.A)(function*(){n.quantity>1&&(n.quantity--,yield e.updateCartItem(n),e.calculateTotal())})()}onQuantityChange(n,e){var o=this;return(0,m.A)(function*(){n.quantity=Math.min(Math.max(e.target.value,1),n.maxQuantity),yield o.updateCartItem(n),o.calculateTotal()})()}updateCartItem(n){var e=this;return(0,m.A)(function*(){try{yield e.cartService.updateCart(n.id,{...n,quantity:n.quantity}).toPromise(),console.log("Cart updated successfully")}catch(o){console.error("Error updating cart:",o),e.showToast("Error updating cart","danger")}})()}deleteCartItem(n){var e=this;return(0,m.A)(function*(){try{const o=yield e.findCartItem(n.product_id);o&&(yield e.cartService.deleteCart(o.id).toPromise(),yield e.loadCartItems())}catch(o){console.error("Error removing item from cart:",o),e.showToast("Error removing item from cart","danger")}})()}deleteSelectedItems(){var n=this;return(0,m.A)(function*(){try{const e=n.items.filter(o=>o.selected);if(!e.length)return;yield Promise.all(e.map(o=>n.deleteCartItem(o))),yield n.loadCartItems(),n.showToast("Selected items removed from cart","danger")}catch(e){console.error("Error removing selected items from cart:",e),n.showToast("Error removing selected items from cart","danger")}})()}findCartItem(n){var e=this;return(0,m.A)(function*(){const c=(yield e.authService.fetchProfileData()).id,f=yield e.cartService.getCartsByPetOwnerId(c).toPromise();return f?f.find(_=>_.product_id===n):null})()}showToast(n,e){var o=this;return(0,m.A)(function*(){(yield o.toastController.create({message:n,color:e,duration:2e3})).present()})()}get isCartEmpty(){return!this.items.length}}return(r=p).\u0275fac=function(n){return new(n||r)(t.rXU(C.m),t.rXU(b.b),t.rXU(x.u),t.rXU(l.K_))},r.\u0275cmp=t.VBU({type:r,selectors:[["app-cart"]],decls:20,vars:10,consts:[["slot","start"],[1,"header-margin-Single-Line"],[1,"titleFont"],["slot","end"],[3,"ionChange","checked","disabled"],["id","select",1,"bodyFont"],[1,"ion-padding"],[4,"ngFor","ngForOf"],[1,"ion-padding","FlexSpaceInBetween"],["class","MakeItFlexAsAColumnNoCenter",4,"ngIf"],["class","notMemberTotal",4,"ngIf"],["class","FilledButtons","fill","clear",3,"click",4,"ngIf"],["fill","clear",1,"FilledButtons",3,"routerLink"],[1,"FlexSpaceInBetween","Itemsdesign2"],[1,"MakeItFlex"],["slot","start",3,"ngModelChange","ionChange","ngModel"],["id","showImg",1,"Item-img",3,"src"],[1,"MakeItFlexAsAColumnNoCenter"],[1,"bodyFont","boldFont"],[1,"bodyFont","price"],["slot","end",1,"buttons"],[3,"click","disabled"],["src","/assets/icons/add-Minus.svg","alt","-",1,"icon"],["type","number","min","1",1,"bodyFont",3,"ngModelChange","ionChange","ngModel","max"],["src","/assets/icons/add-plus.svg","alt","+",1,"icon"],["side","end"],["fill","clear",1,"Delete-items",3,"click"],["src","../../assets/delete-trash.svg",1,"icon"],[1,"notMemberTotal"],["fill","clear",1,"FilledButtons",3,"click"]],template:function(n,e){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t.nrm(3,"ion-back-button"),t.k0s(),t.j41(4,"div",1)(5,"ion-label",2),t.EFF(6,"My Cart"),t.k0s()(),t.j41(7,"ion-buttons",3)(8,"ion-checkbox",4),t.bIt("ionChange",function(c){return e.selectAllItems(c)}),t.k0s(),t.j41(9,"span",5),t.EFF(10),t.k0s()()()(),t.j41(11,"ion-content",6),t.DNE(12,s,20,11,"ion-item-sliding",7),t.k0s(),t.j41(13,"div",8),t.DNE(14,d,9,8,"div",9)(15,y,7,4,"div",10),t.j41(16,"div"),t.DNE(17,O,2,0,"ion-button",11),t.j41(18,"ion-button",12),t.EFF(19," Checkout "),t.k0s()()()),2&n&&(t.R7$(8),t.Y8G("checked",e.selectAll)("disabled",e.isCartEmpty),t.R7$(2),t.JRh(e.selectAll?"unselect all":"select all"),t.R7$(2),t.Y8G("ngForOf",e.items),t.R7$(2),t.Y8G("ngIf",!e.isMember),t.R7$(),t.Y8G("ngIf",e.isMember),t.R7$(2),t.Y8G("ngIf",e.selectedItemsCount>=2),t.R7$(),t.Y8G("routerLink",t.eq3(8,i,e.totalPrice)))},dependencies:[h.Sq,h.bT,g.BC,g.vS,l.Jm,l.QW,l.eY,l.W9,l.eU,l.$w,l.uz,l.LU,l.CE,l.A7,l.he,l.ai,l.hB,l.su,l.el,l.N7,l.T6,l.jL,P.Wk,h.QX],styles:["ion-header[_ngcontent-%COMP%]   ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.icon[_ngcontent-%COMP%]{width:24px;height:auto}#select[_ngcontent-%COMP%]{margin:5px}ion-checkbox[_ngcontent-%COMP%]{--border-radius: 6px;--checkbox-background-checked: var(--Main-One)}ion-checkbox[_ngcontent-%COMP%]::part(container){--border-radius: 6px;border:2px solid var(--Main-One);--checkbox-background: var(--background-color)}ion-item[_ngcontent-%COMP%]{--background: var(--White);--border-color: none}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{font-family:Montserrat,sans-serif!important;font-size:.875rem!important}ion-item[_ngcontent-%COMP%]   ion-checkbox[_ngcontent-%COMP%]::part(container){--checkbox-background: var(--White)}.itemsdesign[_ngcontent-%COMP%]{border-radius:16px;margin:5px;background-color:var(--White);padding:10px;--ion-item-border-width: 0;--ion-item-border-color: transparent}.Itemsdesign[_ngcontent-%COMP%]{border-radius:16px;background-color:var(--White);padding:10px;margin-bottom:10px}.Itemsdesign[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{width:20px}.Itemsdesign2[_ngcontent-%COMP%]{border-radius:16px;background-color:var(--White);padding:10px 0;margin-bottom:10px}.Itemsdesign2[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{width:20px}.item-img[_ngcontent-%COMP%]{border-radius:16px}.Item-img[_ngcontent-%COMP%]{width:50px;height:50px;margin:10px;border-radius:16px}.price[_ngcontent-%COMP%]{color:var(--Main-One)!important}.qt-buttons[_ngcontent-%COMP%]{margin-top:5px;width:25%}.delete-items[_ngcontent-%COMP%]{--background: var(--Main-One);--color: var(--White)!important;border-radius:16px;height:45px;width:45px;margin-bottom:5px;margin-right:5px}.delete-items[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:45px;width:45px}.Delete-items[_ngcontent-%COMP%]{--background: var(--Main-One);--color: var(--White)!important;height:65%;margin-top:13px;border-top-right-radius:16px;border-bottom-right-radius:16px}.notMemberTotal[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;align-content:flex-end;margin-bottom:10px}@media screen and (max-width: 355px){.Item-img[_ngcontent-%COMP%]{display:none!important}ion-item[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{margin-left:10px}.Delete-items[_ngcontent-%COMP%]{height:54%}}","#quantity-controls[_ngcontent-%COMP%]{margin:20px 5px 5px;display:flex;justify-content:center;align-items:center;color:var(--Main-One);font-size:12px}#quantity-controls[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{text-align:center;--ion-item-border-width: 0;--ion-item-border-color: transparent}#quantity-controls[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{justify-content:space-between;margin:9px;font-size:9px;--border-radius: 50%;width:5px;height:5px;display:flex;justify-content:center;align-items:center;--background: var(--Main-Two)}.toolbar-content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:10px;margin-bottom:10px}.checkoutbtn[_ngcontent-%COMP%]{--background:var(--Main-One);--color:var(--White);--border-radius: 16px;padding:70px;height:100px;width:200px}.item-name[_ngcontent-%COMP%]{margin-top:0}ion-footer[_ngcontent-%COMP%]{margin:5px 10px 10px}ion-footer[_ngcontent-%COMP%]   .FilledButtons[_ngcontent-%COMP%]{font-family:Montserrat;font-weight:600;font-size:.875rem;font-style:normal;text-align:center;border-radius:16px;margin-bottom:5px;margin-right:5px;height:9vh;width:26vh;--color: white !important}ion-footer[_ngcontent-%COMP%]   .FilledButtons.FilledButtons[_ngcontent-%COMP%]{background-color:var(--Main-One);color:var(--White)!important}ion-footer[_ngcontent-%COMP%]   .FilledButtons.OutlinedButtons[_ngcontent-%COMP%]{border:1px solid var(--Main-One);color:var(--Main-One)}ion-footer[_ngcontent-%COMP%]   .white[_ngcontent-%COMP%]{color:var(--White)!important}.btndelet[_ngcontent-%COMP%]{background:var(--Main-One)!important;color:var(--White)!important;border-radius:16px;height:45px;width:45px;margin-bottom:5px;margin-right:5px}.btndelet[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{height:45px;width:45px}.btndelet.FilledButtons[_ngcontent-%COMP%]{background-color:var(--Main-One);color:var(--White)!important}.btndelet.OutlinedButtons[_ngcontent-%COMP%]{border:1px solid var(--Main-One);color:var(--Main-One)}.transfer-button[_ngcontent-%COMP%]{position:fixed;bottom:20px;left:50%;transform:translate(-50%);padding:0 95px;border-radius:16px;color:#fff!important;margin-left:10px;margin-right:10px;z-index:1}"]}),p})()}];let $=(()=>{var r;class p{}return(r=p).\u0275fac=function(n){return new(n||r)},r.\u0275mod=t.$C({type:r}),r.\u0275inj=t.G2t({imports:[P.iI.forChild(F),P.iI]}),p})(),j=(()=>{var r;class p{}return(r=p).\u0275fac=function(n){return new(n||r)},r.\u0275mod=t.$C({type:r}),r.\u0275inj=t.G2t({imports:[h.MD,g.YN,l.bv,$]}),p})()},5822:(w,v,u)=>{u.d(v,{u:()=>t});var h=u(5841),g=u(496),l=u(878),P=u(315),m=u(6e3);g.A.defaults.withCredentials=!0;let t=(()=>{var C;class b{constructor(i){this.http=i,this.apiUrl=l.c.apiUrl}getCSRFToken(){return g.A.get(`${this.apiUrl}/sanctum/csrf-cookie`)}register(i){var s=this;return(0,h.A)(function*(){return yield s.getCSRFToken(),g.A.post(`${s.apiUrl}/api/register`,i).then(d=>(localStorage.setItem("token",d.data.token),d.data)).catch(d=>{throw console.error("Login error:",d),d})})()}checkEmail(i){return g.A.post(`${this.apiUrl}/api/check-email`,{email:i})}sendVerificationCode(i){return g.A.post(`${this.apiUrl}/api/send-verification-code`,{email:i})}verifyCode(i){return g.A.post(`${this.apiUrl}/api/verify-code`,i)}login(i){var s=this;return(0,h.A)(function*(){return yield s.getCSRFToken(),g.A.post(`${s.apiUrl}/api/login`,i).then(d=>(localStorage.setItem("token",d.data.token),d.data)).catch(d=>{throw console.error("Login error:",d),d})})()}logout(){const i=localStorage.getItem("token");return g.A.post(`${this.apiUrl}/api/logout`,{},{headers:{Authorization:`Bearer ${i}`}}).then(()=>{localStorage.removeItem("token")})}getProfile(){var i=this;return(0,h.A)(function*(){const s=localStorage.getItem("token");return(yield g.A.get(`${i.apiUrl}/api/petOwner/profile`,{headers:{Authorization:`Bearer ${s}`}})).data.data})()}fetchProfileData(){var i=this;return(0,h.A)(function*(){try{const s=yield i.getProfile();return console.log("Profile response:",s),s}catch(s){throw console.error("Error fetching profile:",s),s}})()}getPetOwnerData(i){const s=localStorage.getItem("token");return g.A.get(`${this.apiUrl}/api/pet_owner/${i}`,{headers:{Authorization:`Bearer ${s}`}})}fetchPetOwnerData(i){return console.log("th id in auth=====>",i),this.getPetOwnerData(i).then(s=>(console.log("pet owner data:",s),s.data.data)).catch(s=>{throw console.error("Error fetching pet owner:",s),s})}updateProfile(i,s){const d=localStorage.getItem("token");return g.A.put(`${this.apiUrl}/api/pet_owner/${s}`,i,{headers:{Authorization:`Bearer ${d}`}})}updateProfileImage(i,s){const d=localStorage.getItem("token");return g.A.post(`${this.apiUrl}/api/pet_owner/image/${s}`,i,{headers:{Authorization:`Bearer ${d}`}})}updatePass(i,s,d){var y=this;return(0,h.A)(function*(){const O=localStorage.getItem("token");try{return(yield g.A.put(`${y.apiUrl}/api/pet-owners/update-password`,{email:i,password:s,password_confirmation:d},{headers:{Authorization:`Bearer ${O}`}})).data}catch(M){throw console.error("Error updating password:",M),M}})()}}return(C=b).\u0275fac=function(i){return new(i||C)(P.KVO(m.Qq))},C.\u0275prov=P.jDH({token:C,factory:C.\u0275fac,providedIn:"root"}),b})()}}]);
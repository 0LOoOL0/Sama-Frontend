"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2170],{2170:(B,b,l)=>{l.r(b),l.d(b,{ProviderservicePageModule:()=>A});var P=l(9351),o=l(7199),g=l(7473),f=l(4170),_=l(5841),e=l(315),$=l(8525),u=l(5110);const F=()=>[1,2,3,4,5],C=(t,c)=>["/bookappointment",t,c];function i(t,c){if(1&t&&(e.j41(0,"div",27),e.qSk(),e.j41(1,"svg",28),e.nrm(2,"path",29),e.k0s()()),2&t){const s=c.$implicit,n=e.XpG();e.R7$(),e.BMQ("fill",s<=n.averageRating?"#F0A441":"#9da4aa")}}function d(t,c){1&t&&(e.j41(0,"div",30)(1,"ion-label",12),e.EFF(2,"No review available"),e.k0s()())}function v(t,c){if(1&t&&(e.j41(0,"div",27),e.qSk(),e.j41(1,"svg",28),e.nrm(2,"path",29),e.k0s()()),2&t){const s=c.$implicit,n=e.XpG(2);e.R7$(),e.BMQ("fill",s<=n.reviews[0].rate?"#F0A441":"#9da4aa")}}function w(t,c){if(1&t&&(e.j41(0,"div")(1,"div",31)(2,"div",6)(3,"div",13)(4,"div",32)(5,"div",33),e.nrm(6,"img",34),e.k0s()(),e.j41(7,"div",8)(8,"ion-label",19),e.EFF(9),e.k0s(),e.j41(10,"div",14),e.DNE(11,v,3,1,"div",15),e.k0s()()(),e.j41(12,"ion-label",12),e.EFF(13),e.k0s()(),e.j41(14,"div",11)(15,"ion-label",12),e.EFF(16),e.k0s()()()()),2&t){const s=e.XpG();e.R7$(6),e.Y8G("src",null==s.reviews[0].petOwner?null:s.reviews[0].petOwner.profile_image,e.B4B),e.R7$(3),e.JRh(null==s.reviews[0].petOwner?null:s.reviews[0].petOwner.first_name),e.R7$(2),e.Y8G("ngForOf",e.lJ4(5,F)),e.R7$(2),e.JRh(s.reviews[0].date),e.R7$(3),e.JRh(s.reviews[0].comment)}}function R(t,c){if(1&t&&(e.j41(0,"div",35)(1,"div",13),e.nrm(2,"img",36)(3,"img",37)(4,"img",38),e.k0s(),e.j41(5,"ion-button",39),e.EFF(6," Book Appointment "),e.k0s()()),2&t){const s=e.XpG();e.R7$(5),e.Y8G("routerLink",e.l_i(1,C,null==s.service?null:s.service.title,null==s.service?null:s.service.provider_id))}}const M=[{path:"",component:(()=>{var t;class c{constructor(n,r,a,p){this.activatedRoute=n,this.providerService=r,this.navCtrl=a,this.navCtrl2=p,this.reviews=[],this.averageRating=0,this.reviewCount=0,this.type="service",this.providerType="",this.showBookAppointmentButton=!1,this.serviceDraft={name:"Bathing",originalPrice:"BD25.00",discountedPrice:"BD20.00",details:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur tincidunt pharetra eu eleifend. Fusce ultricies ligula eu sem varius pharetra. Proin lobortis sed.",rating:4.2,reviewsCount:230,pictures:["assets/pic1.jpg","assets/pic2.jpg","assets/pic3.jpg","assets/pic4.jpg"],reviews:[{name:"Charolette Hanlin",rating:5,comment:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore...",timeAgo:"4 months ago",avatar:"assets/avatar1.png"}]}}ngOnInit(){this.serviceId=+this.activatedRoute.snapshot.paramMap.get("id"),this.serviceId&&(this.loadService(this.serviceId),this.loadReviews(this.serviceId))}loadReviews(n){var r=this;return(0,_.A)(function*(){try{const a=yield r.providerService.getServiceReviewsByServiceId(n);console.log("Reviews fetched successfully:",a.data),r.reviews=a.data;for(const m of r.reviews)if(m.pet_owner_id)try{const O=yield r.loadPetOwner(m.pet_owner_id);m.petOwner=O}catch(O){console.error("Error fetching pet owner for review:",O)}let p=0;const h=r.reviews.length;r.reviews.forEach(m=>{console.log("Review ID:",m.id),console.log("Rating:",m.rate),console.log("Comment:",m.comment),console.log("Time Ago:",m.date),console.log("-------------------------"),p+=m.rate}),r.averageRating=h>0?parseFloat((p/h).toFixed(2)):0,r.reviewCount=h,console.log("Average Rating:",r.averageRating)}catch(a){console.error("Error fetching reviews:",a)}})()}loadService(n){var r=this;return(0,_.A)(function*(){try{var a,p;const h=yield r.providerService.getServiceById(n);r.service=Array.isArray(h.data)?h.data[0]:h.data,null!==(a=r.service)&&void 0!==a&&a.provider_id&&r.loadProvider(r.service.provider_id),console.log("Fetched service with image:",null===(p=r.service)||void 0===p?void 0:p.image)}catch(h){console.error("Error fetching service details:",h)}})()}loadProvider(n){var r=this;return(0,_.A)(function*(){try{const a=yield r.providerService.getProviderById(n),p=Array.isArray(a.data)?a.data[0]:a.data;r.providerType=p.type,r.showBookAppointmentButton="doctor"===r.providerType,console.log("Provider Type:",r.providerType)}catch(a){console.error("Error fetching provider details:",a)}})()}loadPetOwner(n){return this.providerService.getPetOwnerById(n).then(r=>Array.isArray(r.data)?r.data[0]:r.data).catch(r=>{throw console.error("Error fetching pet owner details:",r),r})}navigateToReviews(){this.navCtrl.navigateForward(`/review/${this.type}/${this.serviceId}`)}navigateToAppointment(){var n;if(this.serviceId&&null!==(n=this.service)&&void 0!==n&&n.provider_id){const r=`/bookappointment/${this.serviceId}/${this.service.provider_id}`;console.log("Navigating to:",r),this.navCtrl2.navigateForward(r)}else console.error("Service ID or Provider ID is missing")}}return(t=c).\u0275fac=function(n){return new(n||t)(e.rXU(f.nX),e.rXU($.$),e.rXU(u.q9),e.rXU(u.q9))},t.\u0275cmp=e.VBU({type:t,selectors:[["app-providerservice"]],decls:55,vars:14,consts:[["noReview",""],["slot","start"],[1,"header-margin-Single-Line"],[1,"titleFont"],[1,"ion-padding"],["alt","Service Image",1,"Pimage",3,"src"],[1,"FlexSpaceInBetween"],[1,"blackTitleFont"],[1,"column"],["id","old-price",1,"bodyFont"],["id","new-price",1,"bodyFont","boldFont"],[1,"Margin-Top"],[1,"bodyFont"],[1,"MakeItFlex"],[1,"stars-container"],["class","star",4,"ngFor","ngForOf"],[1,"bodyFont","Rating"],[1,"MakeItCenter"],[1,"subscribe",2,"background-image","url('/assets/bg.svg')"],[1,"bodyFont","boldFont"],["fill","clear","routerLink","/subscription"],[1,"FlexSpaceInBetween","MakeItFlex"],["src","assets/icons/Star.svg",1,"icon","Middle"],[1,"bodyFont","boldFont","countColour"],[1,"bodyFont","boldFont",3,"click"],[4,"ngIf","ngIfElse"],["class","footer FlexSpaceInBetween",4,"ngIf"],[1,"star"],["viewBox","0 0 1024 1024","xmlns","http://www.w3.org/2000/svg","stroke","rgba(0, 0, 0, 0.3)",1,"icon"],["d","M908.1 353.1l-253.9-36.9L540.7 86.1c-3.1-6.3-8.2-11.4-14.5-14.5-15.8-7.8-35-1.3-42.9 14.5L369.8 316.2l-253.9 36.9c-7 1-13.4 4.3-18.3 9.3a32.05 32.05 0 0 0 .6 45.3l183.7 179.1-43.4 252.9a31.95 31.95 0 0 0 46.4 33.7L512 754l227.1 119.4c6.2 3.3 13.4 4.4 20.3 3.2 17.4-3 29.1-19.5 26.1-36.9l-43.4-252.9 183.7-179.1c5-4.9 8.3-11.3 9.3-18.3 2.7-17.5-9.5-33.7-27-36.3z"],[1,"noReview","Margin-Top"],[1,"ReviewContainer"],[1,"square"],[1,"parent"],["alt","Avatar",3,"src"],[1,"footer","FlexSpaceInBetween"],["src","assets/icons/share1.svg",1,"icon"],["src","assets/icons/bag.svg",1,"icon","Middle"],["src","assets/icons/heart.svg",1,"icon"],["fill","clear",1,"FilledButtons","add-to-cart-button",3,"routerLink"]],template:function(n,r){if(1&n){const a=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1),e.nrm(3,"ion-back-button"),e.k0s(),e.j41(4,"div",2)(5,"ion-title",3),e.EFF(6),e.k0s()()()(),e.j41(7,"ion-content",4),e.nrm(8,"img",5)(9,"br"),e.j41(10,"div",6)(11,"ion-label",7),e.EFF(12),e.k0s(),e.j41(13,"div",8)(14,"ion-label",9),e.EFF(15),e.k0s(),e.j41(16,"ion-label",10),e.EFF(17),e.k0s()()(),e.j41(18,"div",11)(19,"ion-label",12),e.EFF(20),e.k0s()(),e.nrm(21,"br"),e.j41(22,"div",13)(23,"div",14),e.DNE(24,i,3,1,"div",15),e.k0s(),e.j41(25,"ion-label",16),e.EFF(26),e.k0s()(),e.nrm(27,"br"),e.j41(28,"div",17)(29,"div",18)(30,"div")(31,"ion-label",19),e.EFF(32,"For exclusive discounts,"),e.k0s(),e.nrm(33,"br"),e.j41(34,"ion-label",19),e.EFF(35,"Be a member?"),e.k0s()(),e.j41(36,"ion-button",20),e.EFF(37,"SUBSCRIBE"),e.k0s()()(),e.nrm(38,"br"),e.j41(39,"div",21)(40,"div",13)(41,"ion-label",19),e.EFF(42,"Reviews"),e.k0s(),e.nrm(43,"img",22),e.j41(44,"div")(45,"ion-label",19),e.EFF(46),e.k0s(),e.j41(47,"ion-label",23),e.EFF(48),e.k0s()()(),e.j41(49,"ion-label",24),e.bIt("click",function(){return e.eBV(a),e.Njj(r.navigateToReviews())}),e.EFF(50,"View All"),e.k0s()(),e.DNE(51,d,3,0,"ng-template",null,0,e.C5r)(53,w,17,6,"div",25),e.k0s(),e.DNE(54,R,7,4,"div",26)}if(2&n){const a=e.sdS(52);e.R7$(6),e.JRh(null==r.service?null:r.service.title),e.R7$(2),e.Y8G("src",null==r.service?null:r.service.image,e.B4B),e.R7$(4),e.JRh(null==r.service?null:r.service.title),e.R7$(3),e.SpI("",null==r.service?null:r.service.old_price,"BHD"),e.R7$(2),e.SpI("",null==r.service?null:r.service.new_price,"BHD"),e.R7$(3),e.JRh(null==r.service?null:r.service.short_description),e.R7$(4),e.Y8G("ngForOf",e.lJ4(13,F)),e.R7$(2),e.SpI("",r.averageRating.toFixed(2)," | 20 reviewed"),e.R7$(20),e.JRh(r.averageRating.toFixed(2)),e.R7$(2),e.SpI("(",r.reviewCount,")"),e.R7$(5),e.Y8G("ngIf",r.reviews&&r.reviews.length>0)("ngIfElse",a),e.R7$(),e.Y8G("ngIf",r.showBookAppointmentButton)}},dependencies:[P.Sq,P.bT,g.Jm,g.QW,g.W9,g.eU,g.he,g.BC,g.ai,g.el,g.N7,f.Wk],styles:["ion-buttons[_ngcontent-%COMP%]{margin-top:20px}.blackTitleFont[_ngcontent-%COMP%]{font-size:1.2rem}.icon[_ngcontent-%COMP%]{width:24px;height:auto}.column[_ngcontent-%COMP%]{display:flex;flex-direction:column}.Margin-Top[_ngcontent-%COMP%]{margin-top:10px}.Middle[_ngcontent-%COMP%]{margin-left:5px;margin-right:5px}.Pimage[_ngcontent-%COMP%]{display:block;margin-left:auto;margin-right:auto;width:80%;max-width:360px;height:auto;border-radius:16px}#old-price[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--Main-One)!important;margin-right:10px;font-size:1rem!important}#new-price[_ngcontent-%COMP%]{color:var(--Main-Two)!important;font-size:1rem!important}.stars-container[_ngcontent-%COMP%]{display:inline-flex;align-items:center;margin-right:3px}.star[_ngcontent-%COMP%]{margin-right:3px}.subscribe[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-around;width:100%;max-width:350px;height:64px;border-radius:16px;padding-right:20px;padding-left:20px;text-align:center}.subscribe[_ngcontent-%COMP%]   .bodyFont[_ngcontent-%COMP%]{color:var(--White)!important}.subscribe[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{font-family:Montserrat;font-optical-sizing:auto;font-style:normal;text-align:center;border-radius:16px;background-color:var(--Main-One);color:#fff;padding:0 16px}.countColour[_ngcontent-%COMP%]{color:var(--Main-One)!important;margin-left:3px}.ReviewContainer[_ngcontent-%COMP%]{width:100%;border-radius:16px;margin:10px 0;padding:16px}.square[_ngcontent-%COMP%]{width:50px;height:50px;margin-right:5px}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]{width:50px;height:50px;position:relative;border-radius:50%;overflow:hidden}.square[_ngcontent-%COMP%]   .parent[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{position:absolute;width:100%;height:100%;background-size:cover;background-position:center}.add-to-cart-button[_ngcontent-%COMP%]{width:50%;background-color:var(--Main-Two)}.footer[_ngcontent-%COMP%]{padding:0 16px}@media screen and (max-width: 350px){.subscribe[_ngcontent-%COMP%]   .bodyFont[_ngcontent-%COMP%]{font-size:.775rem}ion-button[_ngcontent-%COMP%]{padding:0 8px;width:50%}}"]}),c})()}];let I=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[f.iI.forChild(M),f.iI]}),c})(),A=(()=>{var t;class c{}return(t=c).\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.$C({type:t}),t.\u0275inj=e.G2t({imports:[P.MD,o.YN,g.bv,I]}),c})()},8525:(B,b,l)=>{l.d(b,{$:()=>$});var P=l(5841),o=l(496),g=l(878),f=l(5109),_=l(6200),e=l(315);o.A.defaults.withCredentials=!0;let $=(()=>{var u;class F{constructor(){this.apiUrl=`${g.c.apiUrl}/api`,o.A.interceptors.request.use(i=>{const d=localStorage.getItem("token");return d&&(i.headers.Authorization=`Bearer ${d}`),i},i=>Promise.reject(i))}getAllProviders(){return o.A.get(`${this.apiUrl}/providers`)}getProviderById(i){return o.A.get(`${this.apiUrl}/providers/${i}`)}getProviderById2(i){return(0,f.H)(o.A.get(`${this.apiUrl}/providers/${i}`)).pipe((0,_.T)(d=>d.data))}createProvider(i){return o.A.post(`${this.apiUrl}/providers`,i)}getAllProviders2(){var i=this;return(0,P.A)(function*(){return o.A.get(`${i.apiUrl}/providers`).then(d=>d.data)})()}updateProvider(i,d){return o.A.put(`${this.apiUrl}/providers/${i}`,d)}deleteProvider(i){return o.A.delete(`${this.apiUrl}/providers/${i}`)}getServicesByProviderId(i){return o.A.get(`${this.apiUrl}/providers/${i}/services`)}getProductsByProviderId(i){return o.A.get(`${this.apiUrl}/providers/${i}/products`)}getVeterinariansByProviderId(i){return o.A.get(`${this.apiUrl}/providers/${i}/veterinarians`)}getVeterianById(i){return o.A.get(`${this.apiUrl}/veterinarians/${i}`)}getServiceById(i){return o.A.get(`${this.apiUrl}/services/${i}`)}getProductById(i){return o.A.get(`${this.apiUrl}/products/${i}`)}getServiceReviewsByServiceId(i){return o.A.get(`${this.apiUrl}/services/${i}/reviews`)}getPetOwnerById(i){return o.A.get(`${this.apiUrl}/pet_owners/${i}`)}getProductReviewsByProductId(i){return o.A.get(`${this.apiUrl}/products/${i}/reviews`)}getProviderByName(i){return(0,f.H)(o.A.get(`${this.apiUrl}/providers/name/${i}`))}addReview(i){var d=this;return(0,P.A)(function*(){try{console.log("Review data before sending:",i);const v=yield o.A.post(`${d.apiUrl}/reviews`,i);return console.log("Server response:",v.data),v.data}catch(v){throw console.error("Error adding review:",v),v}})()}getAverageRatingByProviderId(i){var d=this;return(0,P.A)(function*(){try{const w=(yield d.getServicesByProviderId(i)).data;let R=0,y=0;for(const I of w)(yield d.getServiceReviewsByServiceId(I.id)).data.forEach(c=>{y+=c.rate,R++});return R>0?y/R:0}catch(v){throw console.error("Error calculating average rating:",v),v}})()}getAverageRatingByProductId(i){var d=this;return(0,P.A)(function*(){try{const w=(yield o.A.get(`${d.apiUrl}/products/${i}/reviews`)).data;return 0===w.length?null:w.reduce((y,M)=>y+M.rate,0)/w.length}catch(v){throw console.error("Error fetching reviews:",v),v}})()}}return(u=F).\u0275fac=function(i){return new(i||u)},u.\u0275prov=e.jDH({token:u,factory:u.\u0275fac,providedIn:"root"}),F})()}}]);